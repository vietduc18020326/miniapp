(self.webpackChunkMiniPolicy=self.webpackChunkMiniPolicy||[]).push([["src_screens_DocumentTypesScreen_DoctypeDetailScreen_tsx"],{19855:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.MenuItem=void 0;var o,a,i,s,l,u=r(n(19452)),c=r(n(70215)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(84481)),p=n(64345),f=n(33823),y=["source","title","textColor"];function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}t.MenuItem=(0,d.memo)((function(e){var t=e.source,n=e.title,r=e.textColor,o=(0,c.default)(e,y);return(0,f.jsxs)(A,Object.assign({},o,{children:[(0,f.jsxs)(v,{children:[t?(0,f.jsx)(h,{source:t}):null,(0,f.jsx)(x,{textColor:r,children:n})]}),(0,f.jsx)(g,{})]}))}));var A=p.styled.TouchableOpacity(o||(o=(0,u.default)([""]))),v=p.styled.View(a||(a=(0,u.default)(["\n  flex-direction: row;\n  align-items: center;\n  padding: 16px;\n"]))),h=p.styled.Image(i||(i=(0,u.default)(["\n  margin-right: 8px;\n"]))),x=p.styled.Text(s||(s=(0,u.default)(["\n  color: ",";\n"])),(function(e){return e.textColor||e.theme.neutral1})),g=p.styled.View(l||(l=(0,u.default)(["\n  height: 1px;\n  background-color: ",";\n  margin: 0 16px;\n"])),(function(e){return e.theme.neutral5}))},99604:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.DoctypeDetailScreen=t.DEFAULT_PARAMS=void 0;var o,a,i,s,l=r(n(19452)),u=r(n(27424)),c=n(58198),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=D(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(84481)),p=n(64345),f=n(35315),y=n(7405),m=n(30975),A=n(39797),v=n(96738),h=n(46763),x=n(39066),g=n(76233),_=n(20349),b=n(11269),j=n(44707),M=n(29287),C=n(33823);function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(D=function(e){return e?n:t})(e)}var S=t.DEFAULT_PARAMS={collection:void 0,storage:void 0},O=(t.DoctypeDetailScreen=(0,d.memo)((function(){var e=(0,p.useNavigationParams)().id,t=(0,f.useDoctypes)(e),n=(0,d.useState)(S),r=(0,u.default)(n,2),o=r[0],a=r[1],i=(0,d.useCallback)((function(e,t,n){return(0,C.jsx)(y.PoliciesItem,{id:e,isLast:n,index:t})}),[]),s=(0,d.useCallback)((function(e,t,n){return(0,C.jsx)(x.MasterDoctypeItem,{id:e,isLast:n,index:t})}),[]),l=(0,h.useSharedValue)(0),m=(0,h.useSharedValue)(0),A=(0,h.useSharedValue)(0);return(0,C.jsx)(j.SelectedItemProvider,{children:(0,C.jsxs)(c.ScreenWrapper,{isGrey:!0,children:[(0,C.jsx)(c.DynamicHeader,{hideSeparator:!0,title:(0,p.stripSpecialCharacters)((null==t?void 0:t.name)||""),rightComponent:(0,C.jsx)(k,{children:(0,C.jsx)(b.FilterIcon,{params:o,onPress:function(){(0,_.navigateToDoctypeFilter)({params:o,setParams:a})}})}),animatedCollapseIndex:l}),(0,C.jsxs)(I,{children:[(0,C.jsx)(M.SelectedHeader,{title:(0,p.stripSpecialCharacters)((null==t?void 0:t.name)||""),animatedHeight:m,animatedTop:A}),(0,C.jsx)(V,{animatedCollapseIndex:l,params:o,id:e,renderItem:i,renderItem2:s,animatedHeight:m,doctype:t})]})]})})})),{code:"function anonymous(){const{selectedIds}=this.__closure;return selectedIds.value.length==0;}",location:"/Volumes/T7/phamduc/policy/src/screens/DocumentTypesScreen/DoctypeDetailScreen.tsx",sourceMap:'{"version":3,"names":["anonymous","selectedIds","__closure","value","length"],"sources":["/Volumes/T7/phamduc/policy/src/screens/DocumentTypesScreen/DoctypeDetailScreen.tsx"],"mappings":"AAuH0C,SAAAA,UAAA,QAAAC,WAAA,OAAAC,SAAA,OAAM,CAAAD,WAAY,CAAAE,KAAM,CAAAC,MAAM,EAAI"}',version:"3.5.4"}),w={code:"function anonymous(layout){const{animatedHeight}=this.__closure;animatedHeight.value=layout.headerHeight;}",location:"/Volumes/T7/phamduc/policy/src/screens/DocumentTypesScreen/DoctypeDetailScreen.tsx",sourceMap:'{"version":3,"names":["anonymous","layout","animatedHeight","__closure","value","headerHeight"],"sources":["/Volumes/T7/phamduc/policy/src/screens/DocumentTypesScreen/DoctypeDetailScreen.tsx"],"mappings":"AA6HkB,SAAAA,SAAMA,CAAIC,MAAA,QAAAC,cAAA,OAAAC,SAAA,CAElBD,cAAc,CAACE,KAAK,CAAGH,MAAM,CAACI,YAAY,CAC5C"}',version:"3.5.4"},P={code:"function anonymous(index){const{animatedCollapseIndex}=this.__closure;animatedCollapseIndex.value=index;}",location:"/Volumes/T7/phamduc/policy/src/screens/DocumentTypesScreen/DoctypeDetailScreen.tsx",sourceMap:'{"version":3,"names":["anonymous","index","animatedCollapseIndex","__closure","value"],"sources":["/Volumes/T7/phamduc/policy/src/screens/DocumentTypesScreen/DoctypeDetailScreen.tsx"],"mappings":"AAiIoB,SAAAA,SAASA,CAAAC,KAAA,QAAAC,qBAAA,OAAAC,SAAA,CAEnBD,qBAAqB,CAACE,KAAK,CAAGH,KAAK,CACrC"}',version:"3.5.4"},V=(0,d.memo)((function(e){var t,r,o=e.animatedCollapseIndex,a=e.params,i=e.id,s=e.renderItem,l=e.renderItem2,u=e.doctype,d=e.animatedHeight,f=(0,j.useSelectedItem)(),y=f.selectedState,x=f.selectedIds,_=(0,h.useDerivedValue)((t=[new n.g.Error,-2,-27],(r=function(){return 0==x.value.length}).__closure={selectedIds:x},r.__initData=O,r.__workletHash=5912787252731,r.__stackDetails=t,r));return(0,C.jsxs)(c.ScrollableTabView.Provider,{scrollEnabled:_,disabledLoadData:y,onLayout:function(){var e=[new n.g.Error,-2,-27],t=function(e){d.value=e.headerHeight};return t.__closure={animatedHeight:d},t.__initData=w,t.__workletHash=2514887566720,t.__stackDetails=e,t}(),onCollapse:function(){var e=[new n.g.Error,-2,-27],t=function(e){o.value=e};return t.__closure={animatedCollapseIndex:o},t.__initData=P,t.__workletHash=0xc693e964b4e,t.__stackDetails=e,t}(),tabs:[{title:(0,p.translate)("policy.all_documents"),content:function(e){return(0,C.jsx)(c.ScrollableTabView.List,{index:e.index,params:Object.assign({id:i},a),requestFn:m.requestPolicyByDoctype,getItemByQuery:v.getPoliciesByQuery,useItemByQuery:v.usePoliciesByQuery,query:"doctype",renderItem:s})}},{title:(0,p.translate)("policy.master_versions"),content:function(e){return(0,C.jsx)(c.ScrollableTabView.List,{index:e.index,params:{id:i},requestFn:A.requestMasterVersionDoctype,getItemByQuery:g.getMasterVersionDoctypesByQuery,useItemByQuery:g.useMasterVersionDoctypesByQuery,renderItem:l})}}],children:[(0,C.jsx)(c.ScrollableTabView.CollapsableTabBar,{children:(0,C.jsx)(T,{children:(0,C.jsx)(B,{numberOfLines:2,children:(0,p.stripSpecialCharacters)((null==u?void 0:u.name)||"")})})}),(0,C.jsx)(c.ScrollableTabView.Content,{})]})})),k=p.styled.View(o||(o=(0,l.default)(["\n  margin-right: 16px;\n"]))),I=p.styled.View(a||(a=(0,l.default)(["\n  background-color: ",";\n  flex: 1;\n"])),(function(e){return e.theme.neutral9})),T=p.styled.View(i||(i=(0,l.default)(["\n  padding-left: 16px;\n  background-color: ",";\n"])),(function(e){return e.theme.backgroundColor})),B=p.styled.Text(s||(s=(0,l.default)(["\n  font-size: 20px;\n  line-height: 28px;\n  font-family: ",";\n  color: ",";\n"])),p.Fonts.SemiBold,(function(e){return e.theme.neutral1}))},50213:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.DoctypeMoreMenu=void 0;var o=r(n(17156)),a=r(n(27424)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=A(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(84481)),s=n(58198),l=n(80780),u=n(64345),c=n(19855),d=n(11361),p=n(20349),f=n(39797),y=n(12134),m=n(33823);function A(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(A=function(e){return e?n:t})(e)}t.DoctypeMoreMenu=(0,u.memoForwardRef)((function(e,t){var n=(0,s.useAnimatedSnapPoints)(),r=n.onViewLayout,A=n.animatedSnapPoints,v=(0,u.useBoolean)(),h=(0,a.default)(v,3),x=h[0],g=h[1],_=h[2],b=(0,u.useTheme)(),j=(0,u.useAsyncFn)((0,o.default)((function*(){return yield(0,f.requestRemoveMasterVersion)({id:e.id})})),[e.id]),M=(0,a.default)(j,2),C=M[0],D=(C.loading,C.error),S=M[1],O=(0,i.useCallback)((function(){g()}),[]),w=(0,i.useCallback)((function(){var n;(0,u.interactManager)((function(){return(0,p.navigateToEditMasterVersion)({id:e.id})}),300),null==(n=t.current)||n.dismiss()}),[e.id]);return(0,u.useAutoToastError)(D),(0,m.jsxs)(s.MyBottomSheet,{name:"doctypes",ref:t,snapPoints:A,children:[(0,m.jsxs)(l.BottomSheetView,{onLayout:r("ok"),children:[(0,m.jsx)(c.MenuItem,{title:(0,u.translate)("policy.edit"),onPress:w}),(0,m.jsx)(c.MenuItem,{textColor:u.Colors.red1,title:(0,u.translate)("policy.remove"),onPress:O}),(0,m.jsx)(d.AnimatedBottomSpace,{})]}),(0,m.jsx)(y.MyConfirmationDialog,{isVisible:x,onCloseRequest:_,title:(0,u.translate)("policy.remove_master_version"),content:(0,u.translate)("policy.are_you_sure_you_want_to_remove_this_master_version"),onPressRightButton:S,colorLeftButton:b.neutral02,bgColorRightButton:b.red1,titleRightButton:(0,u.translate)("policy.remove")})]})}))},39066:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.MasterDoctypeItem=void 0;var o,a,i,s,l,u,c,d,p,f,y=r(n(19452)),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=C(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(84481)),A=n(64345),v=n(76233),h=r(n(30381)),x=n(17575),g=n(35315),_=n(50213),b=n(20349),j=n(58198),M=n(33823);function C(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(C=function(e){return e?n:t})(e)}t.MasterDoctypeItem=(0,m.memo)((function(e){var t=e.id,n=(0,v.useMasterVersionDoctypes)(t),r=(0,A.useUser)(null==n?void 0:n.user_id),o=(0,x.useCollections)(null==n?void 0:n.collection_id),a=(0,g.useDoctypes)(null==n?void 0:n.doctype_id),i=(0,A.useTheme)(),s=(0,m.useRef)(null),l=(0,m.useCallback)((function(){(0,b.navigateToEditMasterVersion)({id:t})}),[t]);return(0,M.jsxs)(D,{onPress:l,children:[(0,M.jsxs)(S,{children:[(0,M.jsx)(w,{children:(0,M.jsx)(P,{numberOfLines:2,children:(0,A.stripSpecialCharacters)(null==n?void 0:n.name)})}),(0,M.jsx)(V,{imageSize:24,source:A.IC_MORE,imageStyle:{tintColor:i.neutral2},onPress:function(){var e;return null==(e=s.current)?void 0:e.present()}})]}),(0,M.jsxs)(O,{children:[(0,M.jsx)(k,{label:(0,A.translate)("policy.created_by"),value:null==r?void 0:r.name}),(0,M.jsx)(k,{label:(0,A.translate)("policy.date"),value:(0,h.default)(null==n?void 0:n.since,"X").format("DD/MM/YYYY")}),(0,M.jsx)(k,{label:(0,A.translate)("policy.type"),value:null==a?void 0:a.name}),(0,M.jsx)(k,{label:(0,A.translate)("policy.collection"),value:null==o?void 0:o.name})]}),(0,M.jsx)(_.DoctypeMoreMenu,{ref:s,id:t})]})}));var D=A.styled.TouchableOpacity(o||(o=(0,y.default)(["\n  padding: 8px 16px;\n  background-color: ",";\n  margin-top: 8px;\n"])),(function(e){return e.theme.backgroundColor})),S=A.styled.View(a||(a=(0,y.default)(["\n  flex-direction: row;\n"]))),O=A.styled.View(i||(i=(0,y.default)([""]))),w=A.styled.View(s||(s=(0,y.default)(["\n  flex: 1;\n"]))),P=A.styled.Text(l||(l=(0,y.default)(["\n  color: ",";\n  font-family: ",";\n  font-size: 16px;\n  line-height: 24px;\n"])),(function(e){return e.theme.neutral1}),A.Fonts.Medium),V=(0,A.styled)(j.UIButton)(u||(u=(0,y.default)([""]))),k=(0,m.memo)((function(e){var t=e.label,n=void 0===t?"":t,r=e.value,o=void 0===r?"":r;return(0,M.jsxs)(I,{children:[(0,M.jsxs)(B,{children:[n,":"]}),(0,M.jsx)(T,{children:(0,M.jsx)(H,{numberOfLines:2,children:o})})]})})),I=A.styled.View(c||(c=(0,y.default)(["\n  flex-direction: row;\n  padding-top: 8px;\n"]))),T=A.styled.View(d||(d=(0,y.default)(["\n  flex: 1;\n"]))),B=A.styled.Text(p||(p=(0,y.default)(["\n  color: ",";\n  font-size: 12px;\n  line-height: 16px;\n  margin-right: 4px;\n  width: 90px;\n"])),(function(e){return e.theme.neutral2})),H=A.styled.Text(f||(f=(0,y.default)(["\n  color: ",";\n  font-family: ",";\n  font-size: 12px;\n  line-height: 16px;\n"])),(function(e){return e.theme.neutral1}),A.Fonts.Medium)},39797:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.requestRemoveMasterVersion=t.requestMasterVersionDoctype=t.requestEditMasterVersion=void 0;var o=r(n(861)),a=r(n(17156)),i=n(64345),s=n(87967),l=n(76233);t.requestMasterVersionDoctype=function(){var e=(0,a.default)((function*(e){var t=(yield i.Fetch.postWithToken("@"+i.Core.systemPath+"/policy/ajax/api/mobile/doc/doctype.mvs",e)).data;return(0,s.batch)((function(){if(t.mvs){(0,l.syncMasterVersionDoctypes)(t.mvs);var n=t.mvs.map((function(e){return e.id.toString()}));(0,l.setMasterVersionDoctypesQuery)((function(t){return Object.assign({},t,{all:e.page&&e.page>1?[].concat((0,o.default)(t.all),(0,o.default)(n)):n})}))}})),t.mvs}));return function(t){return e.apply(this,arguments)}}(),t.requestEditMasterVersion=function(){var e=(0,a.default)((function*(e){var t=(yield i.Fetch.postWithToken("@"+i.Core.systemPath+"/policy/ajax/api/doc/mv/edit",e)).data;return(0,s.batch)((function(){"ok"==t.message&&(0,l.syncMasterVersionDoctypes)((function(t){return[Object.assign({},null==t?void 0:t[e.id],{doctype_id:e.doctype_id,collection_id:e.collection_id,name:e.name})]}))})),t.message}));return function(t){return e.apply(this,arguments)}}(),t.requestRemoveMasterVersion=function(){var e=(0,a.default)((function*(e){var t=(yield i.Fetch.postWithToken("@"+i.Core.systemPath+"/policy/ajax/api/doc/mv/remove",e)).data;return(0,s.batch)((function(){"ok"==t.message&&(0,l.setMasterVersionDoctypesQuery)((function(t){return Object.assign({},t,{all:t.all.filter((function(t){return t!=e.id}))})}))})),t.message}));return function(t){return e.apply(this,arguments)}}()}}]);//# sourceMappingURL=src_screens_DocumentTypesScreen_DoctypeDetailScreen_tsx.chunk.bundle.map?platform=ios