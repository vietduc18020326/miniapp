(self.webpackChunkMiniPolicy=self.webpackChunkMiniPolicy||[]).push([["src_screens_DocumentTypesScreen_DoctypeDetailScreen_tsx"],{11361:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedBottomSpace=void 0;var r=s(n(84481)),o=n(14931),a=s(n(46763)),i=n(33823);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function s(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}var u={code:"function anonymous(){const{aBottom}=this.__closure;return{height:aBottom.value};}"},c=(0,r.memo)((function(e){var t,n=(0,o.useAnimatedSafeAreaInsets)().aBottom,r=(0,a.useAnimatedStyle)(((t=function(){return{height:n.value}}).__closure={aBottom:n},t.__initData=u,t.__workletHash=7203089036154,t));return(0,i.jsx)(a.default.View,Object.assign({},e,{style:[e.style,r]}))}));t.AnimatedBottomSpace=c},19855:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.MenuItem=void 0;var o,a,i,l,s,u=r(n(19452)),c=r(n(70215)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(84481)),f=n(64345),p=n(33823),y=["source","title","textColor"];function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}var v=(0,d.memo)((function(e){var t=e.source,n=e.title,r=e.textColor,o=(0,c.default)(e,y);return(0,p.jsxs)(h,Object.assign({},o,{children:[(0,p.jsxs)(x,{children:[t?(0,p.jsx)(g,{source:t}):null,(0,p.jsx)(j,{textColor:r,children:n})]}),(0,p.jsx)(b,{})]}))}));t.MenuItem=v;var h=f.styled.TouchableOpacity(o||(o=(0,u.default)([""]))),x=f.styled.View(a||(a=(0,u.default)(["\n  flex-direction: row;\n  align-items: center;\n  padding: 16px;\n"]))),g=f.styled.Image(i||(i=(0,u.default)(["\n  margin-right: 8px;\n"]))),j=f.styled.Text(l||(l=(0,u.default)(["\n  color: ",";\n"])),(function(e){return e.textColor||e.theme.neutral1})),b=f.styled.View(s||(s=(0,u.default)(["\n  height: 1px;\n  background-color: ",";\n  margin: 0 16px;\n"])),(function(e){return e.theme.neutral5}))},99604:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.DoctypeDetailScreen=t.DEFAULT_PARAMS=void 0;var o,a,i,l,s=r(n(19452)),u=r(n(27424)),c=n(58198),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=P(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(84481)),f=n(64345),p=n(35315),y=n(7405),m=n(30975),v=n(39797),h=n(96738),x=n(46763),g=n(39066),j=n(76233),b=n(20349),_=n(11269),M=n(44707),O=n(29287),w=n(33823);function P(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(P=function(e){return e?n:t})(e)}var D={collection:void 0,storage:void 0};t.DEFAULT_PARAMS=D;var k=(0,d.memo)((function(){var e=(0,f.useNavigationParams)().id,t=(0,p.useDoctypes)(e),n=(0,d.useState)(D),r=(0,u.default)(n,2),o=r[0],a=r[1],i=(0,d.useCallback)((function(e,t,n){return(0,w.jsx)(y.PoliciesItem,{id:e,isLast:n,index:t})}),[]),l=(0,d.useCallback)((function(e,t,n){return(0,w.jsx)(g.MasterDoctypeItem,{id:e,isLast:n,index:t})}),[]),s=(0,x.useSharedValue)(0),m=(0,x.useSharedValue)(0),v=(0,x.useSharedValue)(0);return(0,w.jsx)(M.SelectedItemProvider,{children:(0,w.jsxs)(c.ScreenWrapper,{isGrey:!0,children:[(0,w.jsx)(c.DynamicHeader,{hideSeparator:!0,title:(0,f.stripSpecialCharacters)((null==t?void 0:t.name)||""),rightComponent:(0,w.jsx)(B,{children:(0,w.jsx)(_.FilterIcon,{params:o,onPress:function(){(0,b.navigateToDoctypeFilter)({params:o,setParams:a})}})}),animatedCollapseIndex:s}),(0,w.jsxs)(T,{children:[(0,w.jsx)(O.SelectedHeader,{title:(0,f.stripSpecialCharacters)((null==t?void 0:t.name)||""),animatedHeight:m,animatedTop:v}),(0,w.jsx)(I,{animatedCollapseIndex:s,params:o,id:e,renderItem:i,renderItem2:l,animatedHeight:m,doctype:t})]})]})})}));t.DoctypeDetailScreen=k;var V={code:"function anonymous(){const{selectedIds}=this.__closure;return selectedIds.value.length==0;}"},C={code:"function anonymous(layout){const{animatedHeight}=this.__closure;animatedHeight.value=layout.headerHeight;}"},S={code:"function anonymous(index){const{animatedCollapseIndex}=this.__closure;animatedCollapseIndex.value=index;}"},I=(0,d.memo)((function(e){var t,n=e.animatedCollapseIndex,r=e.params,o=e.id,a=e.renderItem,i=e.renderItem2,l=e.doctype,s=e.animatedHeight,u=(0,M.useSelectedItem)(),d=u.selectedState,p=u.selectedIds,y=(0,x.useDerivedValue)(((t=function(){return 0==p.value.length}).__closure={selectedIds:p},t.__initData=V,t.__workletHash=5912787252731,t));return(0,w.jsxs)(c.ScrollableTabView.Provider,{scrollEnabled:y,disabledLoadData:d,onLayout:function(){var e=function(e){s.value=e.headerHeight};return e.__closure={animatedHeight:s},e.__initData=C,e.__workletHash=2514887566720,e}(),onCollapse:function(){var e=function(e){n.value=e};return e.__closure={animatedCollapseIndex:n},e.__initData=S,e.__workletHash=0xc693e964b4e,e}(),tabs:[{title:(0,f.translate)("policy.all_documents"),content:function(e){return(0,w.jsx)(c.ScrollableTabView.List,{index:e.index,params:Object.assign({id:o},r),requestFn:m.requestPolicyByDoctype,getItemByQuery:h.getPoliciesByQuery,useItemByQuery:h.usePoliciesByQuery,query:"doctype",renderItem:a})}},{title:(0,f.translate)("policy.master_versions"),content:function(e){return(0,w.jsx)(c.ScrollableTabView.List,{index:e.index,params:{id:o},requestFn:v.requestMasterVersionDoctype,getItemByQuery:j.getMasterVersionDoctypesByQuery,useItemByQuery:j.useMasterVersionDoctypesByQuery,renderItem:i})}}],children:[(0,w.jsx)(c.ScrollableTabView.CollapsableTabBar,{children:(0,w.jsx)(W,{children:(0,w.jsx)(A,{numberOfLines:2,children:(0,f.stripSpecialCharacters)((null==l?void 0:l.name)||"")})})}),(0,w.jsx)(c.ScrollableTabView.Content,{})]})})),B=f.styled.View(o||(o=(0,s.default)(["\n  margin-right: 16px;\n"]))),T=f.styled.View(a||(a=(0,s.default)(["\n  background-color: ",";\n  flex: 1;\n"])),(function(e){return e.theme.neutral9})),W=f.styled.View(i||(i=(0,s.default)(["\n  padding-left: 16px;\n  background-color: ",";\n"])),(function(e){return e.theme.backgroundColor})),A=f.styled.Text(l||(l=(0,s.default)(["\n  font-size: 20px;\n  line-height: 28px;\n  font-family: ",";\n  color: ",";\n"])),f.Fonts.SemiBold,(function(e){return e.theme.neutral1}))},50213:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.DoctypeMoreMenu=void 0;var o=r(n(17156)),a=r(n(27424)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=v(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(84481)),l=n(58198),s=n(80780),u=n(64345),c=n(19855),d=n(11361),f=n(20349),p=n(39797),y=n(12134),m=n(33823);function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(v=function(e){return e?n:t})(e)}var h=(0,u.memoForwardRef)((function(e,t){var n=(0,l.useAnimatedSnapPoints)(),r=n.onViewLayout,v=n.animatedSnapPoints,h=(0,u.useBoolean)(),x=(0,a.default)(h,3),g=x[0],j=x[1],b=x[2],_=(0,u.useTheme)(),M=(0,u.useAsyncFn)((0,o.default)((function*(){return yield(0,p.requestRemoveMasterVersion)({id:e.id})})),[e.id]),O=(0,a.default)(M,2),w=O[0],P=(w.loading,w.error),D=O[1],k=(0,i.useCallback)((function(){j()}),[]),V=(0,i.useCallback)((function(){var n;(0,u.interactManager)((function(){return(0,f.navigateToEditMasterVersion)({id:e.id})}),300),null==(n=t.current)||n.dismiss()}),[e.id]);return(0,u.useAutoToastError)(P),(0,m.jsxs)(l.MyBottomSheet,{name:"doctypes",ref:t,snapPoints:v,children:[(0,m.jsxs)(s.BottomSheetView,{onLayout:r("ok"),children:[(0,m.jsx)(c.MenuItem,{title:(0,u.translate)("policy.edit"),onPress:V}),(0,m.jsx)(c.MenuItem,{textColor:u.Colors.red1,title:(0,u.translate)("policy.remove"),onPress:k}),(0,m.jsx)(d.AnimatedBottomSpace,{})]}),(0,m.jsx)(y.MyConfirmationDialog,{isVisible:g,onCloseRequest:b,title:(0,u.translate)("policy.remove_master_version"),content:(0,u.translate)("policy.are_you_sure_you_want_to_remove_this_master_version"),onPressRightButton:D,colorLeftButton:_.neutral02,bgColorRightButton:_.red1,titleRightButton:(0,u.translate)("policy.remove")})]})}));t.DoctypeMoreMenu=h},39066:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.MasterDoctypeItem=void 0;var o,a,i,l,s,u,c,d,f,p,y=r(n(19452)),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(84481)),v=n(64345),h=n(76233),x=r(n(30381)),g=n(17575),j=n(35315),b=n(50213),_=n(20349),M=n(58198),O=n(33823);function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}var P=(0,m.memo)((function(e){var t=e.id,n=(0,h.useMasterVersionDoctypes)(t),r=(0,v.useUser)(null==n?void 0:n.user_id),o=(0,g.useCollections)(null==n?void 0:n.collection_id),a=(0,j.useDoctypes)(null==n?void 0:n.doctype_id),i=(0,v.useTheme)(),l=(0,m.useRef)(null),s=(0,m.useCallback)((function(){(0,_.navigateToEditMasterVersion)({id:t})}),[t]);return(0,O.jsxs)(D,{onPress:s,children:[(0,O.jsxs)(k,{children:[(0,O.jsx)(C,{children:(0,O.jsx)(S,{numberOfLines:2,children:(0,v.stripSpecialCharacters)(null==n?void 0:n.name)})}),(0,O.jsx)(I,{imageSize:24,source:v.IC_MORE,imageStyle:{tintColor:i.neutral2},onPress:function(){var e;return null==(e=l.current)?void 0:e.present()}})]}),(0,O.jsxs)(V,{children:[(0,O.jsx)(B,{label:(0,v.translate)("policy.created_by"),value:null==r?void 0:r.name}),(0,O.jsx)(B,{label:(0,v.translate)("policy.date"),value:(0,x.default)(null==n?void 0:n.since,"X").format("DD/MM/YYYY")}),(0,O.jsx)(B,{label:(0,v.translate)("policy.type"),value:null==a?void 0:a.name}),(0,O.jsx)(B,{label:(0,v.translate)("policy.collection"),value:null==o?void 0:o.name})]}),(0,O.jsx)(b.DoctypeMoreMenu,{ref:l,id:t})]})}));t.MasterDoctypeItem=P;var D=v.styled.TouchableOpacity(o||(o=(0,y.default)(["\n  padding: 8px 16px;\n  background-color: ",";\n  margin-top: 8px;\n"])),(function(e){return e.theme.backgroundColor})),k=v.styled.View(a||(a=(0,y.default)(["\n  flex-direction: row;\n"]))),V=v.styled.View(i||(i=(0,y.default)([""]))),C=v.styled.View(l||(l=(0,y.default)(["\n  flex: 1;\n"]))),S=v.styled.Text(s||(s=(0,y.default)(["\n  color: ",";\n  font-family: ",";\n  font-size: 16px;\n  line-height: 24px;\n"])),(function(e){return e.theme.neutral1}),v.Fonts.Medium),I=(0,v.styled)(M.UIButton)(u||(u=(0,y.default)([""]))),B=(0,m.memo)((function(e){var t=e.label,n=void 0===t?"":t,r=e.value,o=void 0===r?"":r;return(0,O.jsxs)(T,{children:[(0,O.jsxs)(A,{children:[n,":"]}),(0,O.jsx)(W,{children:(0,O.jsx)(F,{numberOfLines:2,children:o})})]})})),T=v.styled.View(c||(c=(0,y.default)(["\n  flex-direction: row;\n  padding-top: 8px;\n"]))),W=v.styled.View(d||(d=(0,y.default)(["\n  flex: 1;\n"]))),A=v.styled.Text(f||(f=(0,y.default)(["\n  color: ",";\n  font-size: 12px;\n  line-height: 16px;\n  margin-right: 4px;\n  width: 90px;\n"])),(function(e){return e.theme.neutral2})),F=v.styled.Text(p||(p=(0,y.default)(["\n  color: ",";\n  font-family: ",";\n  font-size: 12px;\n  line-height: 16px;\n"])),(function(e){return e.theme.neutral1}),v.Fonts.Medium)},39797:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.requestRemoveMasterVersion=t.requestMasterVersionDoctype=t.requestEditMasterVersion=void 0;var o,a,i,l=r(n(861)),s=r(n(17156)),u=n(64345),c=n(87967),d=n(76233);t.requestMasterVersionDoctype=function(e){return(o=o||(0,s.default)((function*(e){var t=(yield u.Fetch.postWithToken("@"+u.Core.systemPath+"/policy/ajax/api/mobile/doc/doctype.mvs",e)).data;return(0,c.batch)((function(){if(t.mvs){(0,d.syncMasterVersionDoctypes)(t.mvs);var n=t.mvs.map((function(e){return e.id.toString()}));(0,d.setMasterVersionDoctypesQuery)((function(t){return Object.assign({},t,{all:e.page&&e.page>1?[].concat((0,l.default)(t.all),(0,l.default)(n)):n})}))}})),t.mvs}))).apply(this,arguments)};t.requestEditMasterVersion=function(e){return(a=a||(0,s.default)((function*(e){var t=(yield u.Fetch.postWithToken("@"+u.Core.systemPath+"/policy/ajax/api/doc/mv/edit",e)).data;return(0,c.batch)((function(){"ok"==t.message&&(0,d.syncMasterVersionDoctypes)((function(t){return[Object.assign({},null==t?void 0:t[e.id],{doctype_id:e.doctype_id,collection_id:e.collection_id,name:e.name})]}))})),t.message}))).apply(this,arguments)};t.requestRemoveMasterVersion=function(e){return(i=i||(0,s.default)((function*(e){var t=(yield u.Fetch.postWithToken("@"+u.Core.systemPath+"/policy/ajax/api/doc/mv/remove",e)).data;return(0,c.batch)((function(){"ok"==t.message&&(0,d.setMasterVersionDoctypesQuery)((function(t){return Object.assign({},t,{all:t.all.filter((function(t){return t!=e.id}))})}))})),t.message}))).apply(this,arguments)}}}]);//# sourceMappingURL=src_screens_DocumentTypesScreen_DoctypeDetailScreen_tsx.chunk.bundle.map?platform=ios