{"version":3,"file":"src_screens_DetailPostScreen_index_tsx.chunk.bundle","mappings":"sOAgC6CA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,E,4BAhC7CC,EAAAC,EAAAC,EAAA,QACAC,EAAAD,EAAA,OACAE,EAAAF,EAAA,MAQAG,EAAAJ,EAAAC,EAAA,QAOAI,EAAAJ,EAAA,OAMAK,EAAAL,EAAA,OACAM,EAAAN,EAAA,OACAO,EAAAP,EAAA,OACAQ,EAAAR,EAAA,OACAS,EAAAT,EAAA,OACAU,EAAAC,EAAAX,EAAA,QACAY,EAAAZ,EAAA,OACAa,EAAAb,EAAA,OACAc,EAAAd,EAAA,OACAe,EAAAf,EAAA,OAA6CgB,EAAAhB,EAAA,gBAAAiB,EAAAC,GAAA,sBAAAC,QAAA,gBAAAC,EAAA,IAAAD,QAAAE,EAAA,IAAAF,QAAA,OAAAF,EAAA,SAAAC,GAAA,OAAAA,EAAAG,EAAAD,CAAA,GAAAF,EAAA,UAAAnB,EAAAuB,EAAAJ,GAAA,IAAAA,GAAAI,GAAAA,EAAAC,WAAA,OAAAD,EAAA,UAAAA,GAAA,iBAAAA,GAAA,mBAAAA,EAAA,OAAAE,QAAAF,GAAA,IAAAG,EAAAR,EAAAC,GAAA,GAAAO,GAAAA,EAAAC,IAAAJ,GAAA,OAAAG,EAAAE,IAAAL,GAAA,IAAAM,EAAA,GAAAC,EAAAC,OAAAC,gBAAAD,OAAAE,yBAAA,QAAAC,KAAAX,EAAA,eAAAW,GAAAH,OAAAI,UAAAC,eAAAC,KAAAd,EAAAW,GAAA,KAAAI,EAAAR,EAAAC,OAAAE,yBAAAV,EAAAW,GAAA,KAAAI,IAAAA,EAAAV,KAAAU,EAAAC,KAAAR,OAAAC,eAAAH,EAAAK,EAAAI,GAAAT,EAAAK,GAAAX,EAAAW,EAAA,QAAAL,EAAAJ,QAAAF,EAAAG,GAAAA,EAAAa,IAAAhB,EAAAM,GAAAA,CAAA,KAAAW,EAAA,CAAAC,KAAA,mFAAAC,EAAA,CAAAD,KAAA,6IAAAE,EAAA,CAAAF,KAAA,kOAShCG,EAAgBC,EAAAA,kBAAG,EAAAC,EAAAA,OAAK,WAAa,IAADC,EAAAC,EAMJC,EAL3CC,GACE,EAAAC,EAAAA,uBADKC,EAAOF,EAAPE,QAASC,EAAIH,EAAJG,KAAMC,EAAEJ,EAAFI,GAAIC,EAAGL,EAAHK,IAEpBC,GAAO,EAAAC,EAAAA,SAAQL,GACfM,GAAO,EAAAC,EAAAA,YAAWL,GACjBM,GAAQ,EAAAC,EAAAA,6BAARD,KACDE,GAAqB,EAAAC,EAAAA,oBAAgBd,EAAC,iBAAO,CACjDe,WAAYJ,EAAKK,MAClB,GAACC,UAAA,CAAAN,KAhDUA,GAAIX,EAAAkB,WAAA3B,EAAAS,EAAAmB,cAAA,cAAAnB,IAiDVoB,GAAW,EAAAC,EAAAA,gBAAe,GAE1BC,GAAkB,EAAAC,EAAAA,oBAAkB,eAAAvB,EAAA,SACvCwB,GACC,IAAMC,EAAcD,EAAME,YAAYC,cAAcC,EACpDR,EAASJ,MAAQS,CACnB,EAtDM,OAsDLzB,EAAAiB,UAAA,CAAAG,SAtDHA,GAAQpB,EAAAkB,WAAAzB,EAAAO,EAAAmB,cAAA,cAAAnB,CAAA,CAkDkC,GAKxC,IAGI6B,GAA0B,EAAAf,EAAAA,kBAAgB,eAAAd,EAAA,WAI9C,MAAO,CACL8B,SAJ0B,EAAAC,EAAAA,aAAYX,EAASJ,MAAO,CAAC,EAAG,KAAM,CAAC,EAAG,GAAI,CACxEgB,iBAAkBC,EAAAA,cAAcC,QAKpC,EAjEiC,OAiEhClC,EAAAiB,UAAA,CAAAc,YAlE2BA,EAAAA,YAAWX,SAACA,EAAQa,cAC5BA,EAAAA,eAAajC,EAAAkB,WAAAxB,EAAAM,EAAAmB,cAAA,cAAAnB,CAAA,CA0De,IAS1CmC,GAAmB,EAAAC,EAAAA,cAAY,YACnC,EAAAC,EAAAA,yBACA,EAAAC,EAAAA,iBAAoB,MAAJ7B,OAAI,EAAJA,EAAM8B,SAAUlC,EAAIF,EAASG,EAC/C,GAAG,IAEHkC,GAAgE,EAAAC,EAAAA,aAC9D,kBAAM,EAAAC,EAAAA,mBAAkB,CAACC,UAAWtC,GAAI,GACxC,CAACA,IACFuC,GAAA,EAAAC,EAAArE,SAAAgE,EAAA,GAAAM,EAAAF,EAAA,GAHkDG,GAAtBD,EAArBE,QAAwCF,EAAjBG,MAA6BL,EAAA,IAI5DM,GAA8D,EAAAT,EAAAA,aAC5D,kBAAM,EAAAC,EAAAA,mBAAkB,CAACC,UAAWtC,GAAI,GACxC,CAACA,IACF8C,GAAA,EAAAN,EAAArE,SAAA0E,EAAA,GAAAE,EAAAD,EAAA,GAHgBE,EAAUD,EAAnBJ,QAA2CM,GAAHF,EAAnBH,MAA6BE,EAAA,IAS1D,OAJA,EAAAI,EAAAA,YAAU,WACRR,IAAYS,MACd,GAAG,KAGD,EAAAxF,EAAAyF,KAACxG,EAAAyG,kBAAiB,CAAAC,UAChB,EAAA3F,EAAA4F,MAAC3G,EAAA4G,QAAQC,SAAQ,CACfC,QAAS,SACTC,KAAM,UACN1D,KAAS,MAAJG,GAAgB,OAAZX,EAAJW,EAAMwD,iBAAF,EAAJnE,EAAkBQ,OAAW,MAAJG,OAAI,EAAJA,EAAMH,MAAO,GAC3C4D,OAAW,MAAJzD,GAAgB,OAAZV,EAAJU,EAAMwD,iBAAF,EAAJlE,EAAkBmE,SAAa,MAAJzD,OAAI,EAAJA,EAAMyD,QAAS,GAAGP,SAAA,EACpD,EAAA3F,EAAA4F,MAACO,EAAO,CAACC,MAAOvD,EAAmB8C,SAAA,EACjC,EAAA3F,EAAA4F,MAAChG,EAAAyG,WAAU,CAAAV,SAAA,EACT,EAAA3F,EAAAyF,KAACa,EAAS,CAACC,QAASC,EAAAA,OAAOb,UACzB,EAAA3F,EAAAyF,KAACrG,EAAAqH,MAAK,CAACC,OAAQC,EAAAA,sBAEjB,EAAA3G,EAAA4F,MAACgB,EAAY,CAACR,MAAOvC,EAAwB8B,SAAA,EAC3C,EAAA3F,EAAAyF,KAACxG,EAAA4H,OAAM,CAACC,KAAM,GAAIC,QAAS5E,KAC3B,EAAAnC,EAAA4F,MAACxG,EAAA4H,KAAI,CAACZ,MAAOa,EAAAA,aAAaC,IAAIvB,SAAA,EAC5B,EAAA3F,EAAAyF,KAAC0B,EAAS,CAAAxB,SAAM,MAAJpD,OAAI,EAAJA,EAAM6E,QAClB,EAAApH,EAAA4F,MAAChG,EAAAyG,WAAU,CAAAV,SAAA,CACW,YAAf,MAAJlD,OAAI,EAAJA,EAAM8B,WACL,EAAAvE,EAAA4F,MAAA5F,EAAAqH,SAAA,CAAA1B,SAAA,EACE,EAAA3F,EAAAyF,KAAC6B,EAAU,CAAA3B,UACT,EAAA3F,EAAAyF,KAAC8B,EAAM,CACLb,OAAQc,EAAAA,QAASC,kBACX,MAAJhF,OAAI,EAAJA,EAAM8B,WAAY,eAIxB,EAAAvE,EAAAyF,KAACiC,EAAS,CACRtB,MAAOa,EAAAA,aAAaU,IAAIhC,SAAA,GAAK6B,EAAAA,QAASI,iBAClC,MAAJnF,OAAI,EAAJA,EAAM8B,WAAY,aAEpB,EAAAvE,EAAAyF,KAAC7F,EAAAiI,aAAY,CAAAlC,SAAC,WAEd,MACJ,EAAA3F,EAAAyF,KAACiC,EAAS,CAAA/B,UACR,EAAA3F,EAAAyF,KAACxG,EAAA6I,QAAO,CAAC1F,KAAa,IAAPA,mBAMzB,EAAApC,EAAAyF,KAACsC,EAAW,CAACxB,QAASpC,EAAiBwB,UACrC,EAAA3F,EAAAyF,KAACrG,EAAAqH,MAAK,CAACC,OAAQsB,EAAAA,+BAGnB,EAAAhI,EAAAyF,KAACxG,EAAA4G,QAAQoC,KAAI,CACX5C,WAAYA,EACZ6C,WAAY5C,EACZ6C,qBAAqB,EAAAnI,EAAAyF,KAACjG,EAAA4I,cAAa,CAACC,UAAU,EAAOhG,GAAIA,IACzDiG,SAAUhF,EACVyC,QAAS,YAEX,EAAA/F,EAAAyF,KAACxG,EAAA4G,QAAQ0C,MAAK,KACd,EAAAvI,EAAAyF,KAACxG,EAAA4G,QAAQ2C,YAAW,QAI5B,IAEMrC,GAAU,EAAAsC,EAAAA,QAAOC,EAAAA,QAAS1B,KAAhB,CAAqB1I,IAAAA,GAAA,EAAAqK,EAAAnI,SAAA,qJAO/B8F,EAAYmC,EAAAA,OAAOG,iBAAgBrK,IAAAA,GAAA,EAAAoK,EAAAnI,SAAA,+FAOnC2G,EAAYsB,EAAAA,OAAOI,KAAIrK,IAAAA,GAAA,EAAAmK,EAAAnI,SAAA,kHACZsI,EAAAA,MAAMC,SAOjBrB,EAAYe,EAAAA,OAAOI,KAAIpK,IAAAA,GAAA,EAAAkK,EAAAnI,SAAA,kHACZsI,EAAAA,MAAMC,SAOjBnC,GAAe,EAAA6B,EAAAA,QAAOC,EAAAA,QAAS1B,KAAhB,CAAqBtI,IAAAA,GAAA,EAAAiK,EAAAnI,SAAA,0DAIpCuH,EAAcU,EAAAA,OAAOG,iBAAiBI,OAAM,SAAAC,GAAC,MAAK,CACtDC,QAAS,CAACC,IAAK,EAAGC,OAAQ,EAAGC,KAAM,EAAGC,MAAO,GAC9C,GAFmBb,CAEjB9J,IAAAA,GAAA,EAAAgK,EAAAnI,SAAA,mGAMG8G,EAAamB,EAAAA,OAAOzB,KAAIpI,IAAAA,GAAA,EAAA+J,EAAAnI,SAAA,+FAMxB+G,EAASkB,EAAAA,OAAOhC,MAAK5H,IAAAA,GAAA,EAAA8J,EAAAnI,SAAA,mEAIzBoB,EAAAA,QACaD,C","sources":["webpack:///./src/screens/DetailPostScreen/index.tsx"],"sourcesContent":["import React, {memo, useCallback, useEffect} from 'react';\nimport {Avatar, Comment, FullScreenWrapper, TimeAgo} from '@true/ui';\nimport {\n  Fonts,\n  goBack,\n  styled,\n  useAsyncFn,\n  useNavigationParams,\n  useUser,\n} from '@true/core';\nimport Animated, {\n  Extrapolation,\n  interpolate,\n  useAnimatedStyle,\n  useSharedValue,\n  useWorkletCallback,\n} from 'react-native-reanimated';\nimport {\n  Image,\n  NativeScrollEvent,\n  NativeSyntheticEvent,\n  View,\n} from 'react-native';\nimport {IC_OUTLINED_LEFT, IC_OUTLINED_MORE_HORIZ} from '@true/asset';\nimport {useAnimatedSafeAreaInsets} from 'react-native-safe-area-context';\nimport {globalStyles} from '@/utils/globalStyle';\nimport {PostThumbnail} from '@/components/PostThumbnail';\nimport {useUpdates} from '@/store/updates';\nimport TypePost from '@/services/TypePostService';\nimport {FlexCenter, STextDivider} from '@/utils/helper';\nimport {requestUpdatePost} from '@/store/updates/function';\nimport {setActiveUpdate} from '@/zustand/activeUpdate';\nimport {openActionPostScreen} from '@/utils';\n\nexport interface DetailPostScreenParams {\n  user_id: number;\n  time: number;\n  id: number;\n  hid: string;\n}\n\nexport const DetailPostScreen = memo(function () {\n  const {user_id, time, id, hid} =\n    useNavigationParams<DetailPostScreenParams>();\n  const user = useUser(user_id);\n  const data = useUpdates(id);\n  const {aTop} = useAnimatedSafeAreaInsets();\n  const animatedPaddingTop = useAnimatedStyle(() => ({\n    paddingTop: aTop.value,\n  }));\n  const scroll_x = useSharedValue(0);\n\n  const onContentScroll = useWorkletCallback(\n    (event: NativeSyntheticEvent<NativeScrollEvent>) => {\n      const scrollValue = event.nativeEvent.contentOffset.y;\n      scroll_x.value = scrollValue;\n    },\n    [],\n  );\n\n  const animatedTextHeaderStyle = useAnimatedStyle(() => {\n    const info_header_opacity = interpolate(scroll_x.value, [0, 120], [0, 1], {\n      extrapolateRight: Extrapolation.CLAMP,\n    });\n    return {\n      opacity: info_header_opacity,\n    };\n  });\n\n  const openActionUpdate = useCallback(() => {\n    openActionPostScreen();\n    setActiveUpdate(data?.truetype, id, user_id, hid);\n  }, []);\n\n  const [{loading: firstLoading, error: firstError}, loadFirst] = useAsyncFn(\n    () => requestUpdatePost({update_id: id}),\n    [id],\n  );\n  const [{loading: refreshing, error: refreshError}, refresh] = useAsyncFn(\n    () => requestUpdatePost({update_id: id}),\n    [id],\n  );\n\n  useEffect(() => {\n    loadFirst().then();\n  }, []);\n\n  return (\n    <FullScreenWrapper>\n      <Comment.Provider\n        appName={'inside'}\n        type={'comment'}\n        hid={data?.attachment?.hid || data?.hid || ''}\n        token={data?.attachment?.token || data?.token || ''}>\n        <SHeader style={animatedPaddingTop}>\n          <FlexCenter>\n            <SIconBack onPress={goBack}>\n              <Image source={IC_OUTLINED_LEFT} />\n            </SIconBack>\n            <SAnimateInfo style={animatedTextHeaderStyle}>\n              <Avatar size={32} userKey={user_id} />\n              <View style={globalStyles.ml8}>\n                <STextUser>{user?.name}</STextUser>\n                <FlexCenter>\n                  {data?.truetype !== 'update' ? (\n                    <>\n                      <SIconSmall>\n                        <SImage\n                          source={TypePost.getTypePostImage(\n                            data?.truetype || 'update',\n                          )}\n                        />\n                      </SIconSmall>\n                      <STextTime\n                        style={globalStyles.ml4}>{`${TypePost.getReactionText(\n                        data?.truetype || 'update',\n                      )}`}</STextTime>\n                      <STextDivider> | </STextDivider>\n                    </>\n                  ) : null}\n                  <STextTime>\n                    <TimeAgo time={time * 1000} />\n                  </STextTime>\n                </FlexCenter>\n              </View>\n            </SAnimateInfo>\n          </FlexCenter>\n          <SIconOption onPress={openActionUpdate}>\n            <Image source={IC_OUTLINED_MORE_HORIZ} />\n          </SIconOption>\n        </SHeader>\n        <Comment.List\n          refreshing={refreshing}\n          onLoadData={refresh}\n          ListHeaderComponent={<PostThumbnail isInFeed={false} id={id} />}\n          onScroll={onContentScroll}\n          appName={'inside'}\n        />\n        <Comment.Input />\n        <Comment.BottomSheet />\n      </Comment.Provider>\n    </FullScreenWrapper>\n  );\n});\n\nconst SHeader = styled(Animated.View)`\n  background-color: white;\n  padding: 8px 16px 8px 0;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n`;\nconst SIconBack = styled.TouchableOpacity`\n  width: 48px;\n  height: 48px;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst STextUser = styled.Text`\n  font-family: ${Fonts.Regular};\n\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 16px;\n  color: #242424;\n`;\nconst STextTime = styled.Text`\n  font-family: ${Fonts.Regular};\n\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n  color: #666666;\n`;\nconst SAnimateInfo = styled(Animated.View)`\n  flex-direction: row;\n  align-items: center;\n`;\nconst SIconOption = styled.TouchableOpacity.attrs(p => ({\n  hitSlop: {top: 8, bottom: 8, left: 8, right: 8},\n}))`\n  width: 24px;\n  height: 24px;\n  align-items: center;\n  justify-content: flex-start;\n`;\nconst SIconSmall = styled.View`\n  width: 16px;\n  height: 16px;\n  align-items: center;\n  justify-content: center;\n`;\nconst SImage = styled.Image`\n  tint-color: #666666;\n  width: 16px;\n  height: 16px;\n`;\nexport default DetailPostScreen;\n"],"names":["_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_templateObject6","_templateObject7","_templateObject8","_react","_interopRequireWildcard","require","_ui","_core","_reactNativeReanimated","_reactNative","_asset","_reactNativeSafeAreaContext","_globalStyle","_PostThumbnail","_updates","_TypePostService","_interopRequireDefault","_helper","_function","_activeUpdate","_utils","_jsxRuntime","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_worklet_9978501313055_init_data","code","_worklet_4428087754035_init_data","_worklet_4966309020424_init_data","DetailPostScreen","exports","memo","_data$attachment","_data$attachment2","anonymous","_useNavigationParams","useNavigationParams","user_id","time","id","hid","user","useUser","data","useUpdates","aTop","useAnimatedSafeAreaInsets","animatedPaddingTop","useAnimatedStyle","paddingTop","value","__closure","__initData","__workletHash","scroll_x","useSharedValue","onContentScroll","useWorkletCallback","event","scrollValue","nativeEvent","contentOffset","y","animatedTextHeaderStyle","opacity","interpolate","extrapolateRight","Extrapolation","CLAMP","openActionUpdate","useCallback","openActionPostScreen","setActiveUpdate","truetype","_useAsyncFn","useAsyncFn","requestUpdatePost","update_id","_useAsyncFn2","_slicedToArray2","_useAsyncFn2$","loadFirst","loading","error","_useAsyncFn3","_useAsyncFn4","_useAsyncFn4$","refreshing","refresh","useEffect","then","jsx","FullScreenWrapper","children","jsxs","Comment","Provider","appName","type","attachment","token","SHeader","style","FlexCenter","SIconBack","onPress","goBack","Image","source","IC_OUTLINED_LEFT","SAnimateInfo","Avatar","size","userKey","View","globalStyles","ml8","STextUser","name","Fragment","SIconSmall","SImage","TypePost","getTypePostImage","STextTime","ml4","getReactionText","STextDivider","TimeAgo","SIconOption","IC_OUTLINED_MORE_HORIZ","List","onLoadData","ListHeaderComponent","PostThumbnail","isInFeed","onScroll","Input","BottomSheet","styled","Animated","_taggedTemplateLiteralLoose2","TouchableOpacity","Text","Fonts","Regular","attrs","p","hitSlop","top","bottom","left","right"],"sourceRoot":""}