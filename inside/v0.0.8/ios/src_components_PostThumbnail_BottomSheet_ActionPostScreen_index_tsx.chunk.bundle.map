{"version":3,"file":"src_components_PostThumbnail_BottomSheet_ActionPostScreen_index_tsx.chunk.bundle","mappings":"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","sources":["webpack:///./src/components/PostThumbnail/BottomSheet/ActionPostScreen/index.tsx","webpack:///./src/store/saved/function.ts"],"sourcesContent":["import {BottomSheetView, useBottomSheetNavigator} from '@true/ui';\nimport React, {memo, useCallback} from 'react';\nimport {ImageSourcePropType} from 'react-native';\nimport {useActiveUpdate} from '@/zustand/activeUpdate';\nimport {\n  navigateToCreateEvent,\n  navigateToCreatePollScreen,\n  navigateToCreatePostScreen,\n  navigateToCreateStyledUpdateScreen,\n  navigateToCreateTopicScreen,\n} from '@/utils';\nimport {Fonts, getMe, goBack, styled} from '@true/core';\nimport {IC_FILLED_BOOKMARK, Icons} from '@true/asset';\nimport {requestPinnedPost, requestRemovePost} from '@/store/updates/function';\nimport {getUpdates} from '@/store/updates';\nimport {requestToggleSaved} from '@/store/saved/function';\nimport {ETypeUpdate} from '@/store/updates/type';\n\ninterface ItemActionProps {\n  text: string;\n  image: ImageSourcePropType;\n  onPress: () => void;\n  highlight?: boolean;\n}\n\nconst ItemAction = memo(function (props: ItemActionProps) {\n  const {text, image, onPress, highlight} = props;\n  return (\n    <SItemWrapper onPress={onPress}>\n      <SIcon>\n        <SImage source={image} highlight={highlight} />\n      </SIcon>\n      <STextView>\n        <SText highlight={highlight}>{text}</SText>\n      </STextView>\n    </SItemWrapper>\n  );\n});\n\nexport const ActionPostScreen = memo(function () {\n  const {type, id, user_id, hid} = useActiveUpdate();\n  const myId = getMe()?.id;\n  const {onViewLayout} = useBottomSheetNavigator();\n\n  const onNavigateToEditScreen = useCallback(() => {\n    const update = getUpdates(id);\n    if (type === ETypeUpdate.EVENT) {\n      navigateToCreateEvent({\n        id: id,\n      });\n    } else if (type === ETypeUpdate.POLL) {\n      navigateToCreatePollScreen({\n        id: id,\n      });\n    } else if (type === ETypeUpdate.TOPIC) {\n      navigateToCreateTopicScreen({\n        id: update?.attachment.id,\n      });\n    } else if (type === ETypeUpdate.STYLED) {\n      navigateToCreateStyledUpdateScreen({\n        id: id,\n      });\n    } else {\n      navigateToCreatePostScreen({\n        // @ts-ignore\n        type: type || ETypeUpdate.TOPIC,\n        id: id,\n      });\n    }\n    // goBack();\n    return;\n  }, [type, id]);\n\n  const onSaved = useCallback(async () => {\n    await requestToggleSaved({\n      hid: hid || '',\n      status: 1,\n    }).then();\n    goBack();\n    return;\n  }, [id]);\n\n  const onPin = useCallback(async () => {\n    await requestPinnedPost({\n      id: id || 0,\n    }).then();\n    goBack();\n    return;\n  }, [id]);\n\n  const onRemove = useCallback(async () => {\n    await requestRemovePost({\n      id: id,\n      metatype: type || 'update',\n    });\n    goBack();\n    return;\n  }, [id]);\n\n  return (\n    <BottomSheetView onLayout={onViewLayout('headers')}>\n      <SContainer>\n        <ItemAction\n          image={IC_FILLED_BOOKMARK}\n          text={'Save update'}\n          onPress={onSaved}\n        />\n        {myId === user_id ? (\n          <ItemAction\n            image={Icons.Filled.UNDERLINE_PENCIL}\n            text={'Edit update'}\n            onPress={onNavigateToEditScreen}\n          />\n        ) : null}\n        <ItemAction\n          image={Icons.Filled.PIN}\n          text={'Pin update'}\n          onPress={onPin}\n        />\n        <ItemAction\n          image={Icons.Filled.TRASH}\n          text={'Remove update'}\n          onPress={onRemove}\n          highlight\n        />\n      </SContainer>\n    </BottomSheetView>\n  );\n});\nconst SContainer = styled.View`\n  width: 100%;\n  padding: 0 16px;\n  margin-top: 16px;\n`;\nconst SItemWrapper = styled.TouchableOpacity`\n  flex-direction: row;\n  align-items: flex-start;\n  margin-bottom: 16px;\n`;\nconst STextView = styled.View`\n  flex: 1;\n  padding-bottom: 16px;\n  border-bottom-width: 1px;\n  border-bottom-color: #ebebeb;\n`;\nconst SIcon = styled.View`\n  width: 24px;\n  height: 24px;\n  align-items: center;\n  justify-content: center;\n  margin-right: 12px;\n`;\nconst SImage = styled.Image<{highlight?: boolean}>`\n  width: 24px;\n  height: 24px;\n  tint-color: ${p => (p.highlight ? p.theme.red1 : p.theme.neutral1)};\n`;\nconst SText = styled.Text<{highlight?: boolean}>`\n  font-family: ${Fonts.Regular};\n\n  font-weight: 400;\n  font-size: 16px;\n  line-height: 24px;\n  color: ${p => (p.highlight ? p.theme.red1 : p.theme.neutral1)};\n`;\n","import {Core, Fetch, ToastService} from '@true/core';\nimport {batch} from 'react-redux';\nimport {ISaved} from '@/store/saved/type';\nimport {setSavedQuery, syncSaved} from '@/store/saved/index';\n\nexport const requestSavedItems = async () => {\n  const {data} = await Fetch.postWithToken<{\n    saved: ISaved[];\n  }>(`@${Core.systemPath}/inside/ajax/api/profile/get?tail=saved`);\n  batch(() => {\n    if (data.saved) {\n      syncSaved(data.saved);\n      setSavedQuery(prev => ({\n        ...prev,\n        ['all']: data.saved.map(item => item.id.toString()),\n      }));\n    }\n  });\n};\n\nexport const requestToggleSaved = async (params: {\n  hid: string;\n  status: 1 | -1;\n}) => {\n  const {data} = await Fetch.postWithToken<{\n    obj: ISaved;\n    saved: number;\n  }>(`@${Core.systemPath}/inside/ajax/api/pref/save`, params);\n  batch(() => {\n    if (data.saved) {\n      setSavedQuery(prev => ({\n        ...prev,\n        ['all']: [...prev.all.filter(id => id !== data.obj.id.toString())],\n      }));\n      ToastService.show('Saved successfully');\n    }\n  });\n  return data.saved;\n};\n"],"names":["_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_templateObject6","_ui","require","_react","e","r","__esModule","default","t","_getRequireWildcardCache","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","_interopRequireWildcard","_activeUpdate","_utils","_core","_asset","_function","_updates","_function2","_type","_jsxRuntime","WeakMap","ItemAction","memo","props","text","image","onPress","highlight","jsxs","SItemWrapper","children","jsx","SIcon","SImage","source","STextView","SText","SContainer","exports","_getMe","_useActiveUpdate","useActiveUpdate","type","id","user_id","hid","myId","getMe","onViewLayout","useBottomSheetNavigator","onNavigateToEditScreen","useCallback","update","getUpdates","ETypeUpdate","EVENT","navigateToCreateEvent","POLL","navigateToCreatePollScreen","TOPIC","navigateToCreateTopicScreen","attachment","STYLED","navigateToCreateStyledUpdateScreen","navigateToCreatePostScreen","onSaved","_asyncToGenerator2","requestToggleSaved","status","then","goBack","onPin","requestPinnedPost","onRemove","requestRemovePost","metatype","BottomSheetView","onLayout","IC_FILLED_BOOKMARK","Icons","Filled","UNDERLINE_PENCIL","PIN","TRASH","styled","View","_taggedTemplateLiteralLoose2","TouchableOpacity","Image","p","theme","red1","neutral1","Text","Fonts","Regular","_ref","_ref2","_reactRedux","_index","data","Fetch","postWithToken","Core","systemPath","batch","saved","syncSaved","setSavedQuery","prev","assign","_defineProperty2","map","item","toString","apply","arguments","params","_toConsumableArray2","all","filter","obj","ToastService","show","_x"],"sourceRoot":""}