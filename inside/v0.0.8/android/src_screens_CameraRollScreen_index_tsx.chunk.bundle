(self.webpackChunkInside=self.webpackChunkInside||[]).push([["src_screens_CameraRollScreen_index_tsx"],{80810:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.CameraRollPicker=void 0;var i,o,a,l,u,s,c=r(t(19452)),d=r(t(861)),f=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=S(n);if(t&&t.has(e))return t.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(t(84481)),p=t(92571),m=t(46842),y=r(t(15159)),g=t(4007),h=t(74186),v=t(8937),x=t(46763),b=t(94505),P=t(33823);function S(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(S=function(e){return e?t:n})(e)}var j=function(e){return e.Photos="Photos",e.Videos="Videos",e.All="All",e}(j||{}),k=(n.CameraRollPicker=(0,g.memoForwardRef)((function(e,n){var t=e.emptyText,r=e.groupName,i=e.onSelectImage,o=e.onSelectImages,a=e.selected,l=e.groupTypes,u=e.isMarked,s=e.isBottomSheet,c=(0,v.useGallery)({pageSize:24,groupName:r,groupTypes:l}),S=c.photos,j=c.loadNextPagePictures,A=c.hasNextPage,I=c.isLoadingNextPage,E=c.isLimited,D=(0,x.useSharedValue)(0),M=(0,f.useRef)(a),L=(0,f.useMemo)((function(){return s?h.BottomSheetFlatList:p.FlatList}),[s]),N=(0,g.useTheme)(),G=(0,b.useGalleryPermission)({autoRequestPermission:!0}),W=G.readPermissionStatus,B=(G.refreshPermissions,G.isLoading,(0,f.useMemo)((function(){return"granted"===W||"limited"===W}),[W]),(0,f.useCallback)((function(){p.ActionSheetIOS.showActionSheetWithOptions({options:["Cancel","Add more photos","Change setting permission"],cancelButtonIndex:0,userInterfaceStyle:"dark"==N.name?"dark":"light"},(function(e){0===e||(1===e?(0,m.iosRefreshGallerySelection)().then():2===e&&p.Linking.openSettings().then())}))}),[])),z=(0,f.useCallback)((function(e){var n,t,r=(null==(n=e.nativeEvent)||null==(t=n.layout)?void 0:t.width)||p.Dimensions.get("window").width;D.value=(r-3)/3}),[]),F=(0,f.useCallback)((function(e){if(i&&i(e),M.current){var n=(0,d.default)(M.current).filter((function(n){return"android"===p.Platform.OS?n.fileName!==e.fileName:n.url!==e.url}));n.length===M.current.length?M.current=[].concat((0,d.default)(M.current),[e]):M.current=n,null==o||o(M.current)}}),[i,o,M]);(0,f.useImperativeHandle)(n,(function(){return{onImagePress:F}}));var V=(0,f.useCallback)((function(e){var n=e.item,t=a.findIndex((function(e){return"android"===p.Platform.OS?e.fileName===n.fileName:e.url===n.url}));return(0,P.jsx)(y.default,{isMarked:u,isSelected:t,onSelectItem:F,photo:n,imageSize:D})}),[a,F,D]),q=(0,f.useMemo)((function(){return[{url:"add-media",date:new Date,isButton:!0}].concat(S)}),[S]),H=(0,f.useCallback)((function(){return A&&I?(0,P.jsx)(p.ActivityIndicator,{size:"large",color:"#007AFF",style:{alignSelf:"center"}}):null}),[A,I]);return(0,P.jsxs)(k,{onLayout:z,children:[E?(0,P.jsx)(w,{onPress:B,activeOpacity:.9,children:(0,P.jsxs)(R,{children:["Edit Permission Photos"," ",(0,P.jsx)(T,{children:"Change Permission"})]})}):null,S?(0,P.jsx)(L,{ListFooterComponent:H,renderItem:V,keyExtractor:_,data:q,extraData:S||a.length||D,onEndReachedThreshold:.01,onEndReached:(null==S?void 0:S.length)<24||!A?void 0:j,numColumns:3,ListEmptyComponent:(0,P.jsx)(O,{children:(0,P.jsx)(C,{children:t})})}):null]})})),g.styled.View(i||(i=(0,c.default)(["\n  flex: 1;\n  background-color: ",";\n"])),(function(e){return e.theme.backgroundColor}))),O=g.styled.View(o||(o=(0,c.default)(["\n  flex: 1;\n  justify-content: center;\n  background-color: ",";\n"])),(function(e){return e.theme.backgroundColor})),C=g.styled.Text(a||(a=(0,c.default)(["\n  color: ",";\n  font-size: 16px;\n  text-align: center;\n"])),(function(e){return e.theme.grey1})),_=function(e){return"camera-roll "+e.url},w=g.styled.TouchableOpacity(l||(l=(0,c.default)(["\n  background-color: rgba(240, 247, 255, 1);\n  padding: 6px 8px;\n  border: 1px solid rgba(224, 224, 224, 1);\n  margin-top: -5px;\n"]))),R=g.styled.Text(u||(u=(0,c.default)(["\n  font-family: ",";\n  \n  font-size: 13px;\n  line-height: 20px;\n  color: #242424;\n"])),g.Fonts.Regular),T=g.styled.Text(s||(s=(0,c.default)(["\n  font-family: ",";\n  \n  font-size: 13px;\n  line-height: 20px;\n  color: ",";\n  text-decoration: underline;\n  text-decoration-color: ",";\n"])),g.Fonts.Bold,(function(e){return e.theme.primaryColor}),(function(e){return e.theme.primaryColor}))},8937:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.useGallery=n.isIOS=n.isAndroid=n.isAboveIOS14=n.convertCameraRollPicturesToImageDtoType=void 0;var i=r(t(861)),o=r(t(17156)),a=r(t(27424)),l=t(46842),u=t(84481),s=t(92571),c=n.isIOS="ios"===s.Platform.OS,d=n.isAndroid="android"===s.Platform.OS,f=n.isAboveIOS14=c&&parseInt(s.Platform.Version,10)>=14,p=n.convertCameraRollPicturesToImageDtoType=function(e){return e.map((function(e){var n,t;return{url:e.node.image.uri,size:e.node.image.fileSize,fileName:e.node.image.filename,type:e.node.type,playableDuration:(null==e||null==(n=e.node)||null==(t=n.image)?void 0:t.playableDuration)||0}}))};n.useGallery=function(e){var n=e.pageSize,t=void 0===n?30:n,r=e.groupName,c=e.groupTypes,m=(0,u.useState)(!1),y=(0,a.default)(m,2),g=y[0],h=y[1],v=(0,u.useState)(!1),x=(0,a.default)(v,2),b=x[0],P=x[1],S=(0,u.useState)(!1),j=(0,a.default)(S,2),k=j[0],O=j[1],C=(0,u.useState)(!1),_=(0,a.default)(C,2),w=_[0],R=_[1],T=(0,u.useRef)(void 0),A=(0,u.useState)([]),I=(0,a.default)(A,2),E=I[0],D=I[1],M=(0,u.useState)(!1),L=(0,a.default)(M,2),N=L[0],G=L[1],W=(0,u.useRef)(!1),B=(0,u.useCallback)((0,o.default)((function*(){if(!(g||k||W.current))try{W.current=!0,T.current?O(!0):h(!0);var e=yield l.CameraRoll.getPhotos(Object.assign({first:t,after:T.current,assetType:"All",groupName:r,groupTypes:c},d&&{include:["filename","playableDuration"]})),n=e.edges,o=e.page_info,a=e.limited;a&&G(a);var u=p(n);D((function(e){return[].concat((0,i.default)(e||[]),(0,i.default)(u))})),T.current=o.end_cursor,R(o.has_next_page)}catch(e){console.error("useGallery getPhotos error:",e)}finally{h(!1),O(!1),W.current=!1}})),[T,r,c,t]),z=(0,u.useCallback)((0,o.default)((function*(){if(!W.current&&!b)try{P(!0),W.current=!0;var e=yield l.CameraRoll.getPhotos(Object.assign({first:t,assetType:"All",groupName:r,groupTypes:c,after:void 0},d&&{include:["filename","playableDuration"]})),n=e.edges,i=e.page_info,o=e.limited,a=p(n);D(a),o&&G(o),T.current=i.end_cursor,R(i.has_next_page)}catch(e){console.error("useGallery getNewPhotos error:",e)}finally{P(!1),W.current=!1}})),[t,r,c,b]),F=(0,u.useCallback)((0,o.default)((function*(){h(!0);try{T?O(!0):h(!0);var e=yield l.CameraRoll.getPhotos(Object.assign({first:t,after:"",assetType:"All",groupName:r,groupTypes:c},d&&{include:["playableDuration","filename"]})),n=e.edges,o=e.page_info,a=e.limited,u=p(n);D((0,i.default)(u)),a&&G(a),T.current=o.end_cursor,R(o.has_next_page)}catch(e){console.error("useGallery refresh error:",e)}finally{h(!1),O(!1)}})),[t,c,r]);return(0,u.useEffect)((function(){null!=E&&E.length||B().then()}),[E]),(0,u.useEffect)((function(){var e,n=s.AppState.addEventListener("change",(e=(0,o.default)((function*(e){"active"===e&&z().then()})),function(n){return e.apply(this,arguments)}));return function(){n.remove()}}),[z]),(0,u.useEffect)((function(){var e;return f&&(e=l.cameraRollEventEmitter.addListener("onLibrarySelectionChange",(function(e){z().then()}))),function(){f&&e&&e.remove()}}),[z]),{refresh:F,photos:E,loadNextPagePictures:B,isLoading:g,isLoadingNextPage:k,isReloading:b,hasNextPage:w,isLimited:N}}},94505:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.useGalleryPermission=void 0;var i=r(t(17156)),o=r(t(27424)),a=t(84481),l=t(92571),u=t(46842),s=t(8937);n.useGalleryPermission=function(e){var n=e.autoRequestPermission,t=(0,a.useState)(),r=(0,o.default)(t,2),c=r[0],d=r[1],f=(0,a.useState)(),p=(0,o.default)(f,2),m=p[0],y=p[1],g=(0,a.useState)(!1),h=(0,o.default)(g,2),v=h[0],x=h[1],b=(0,a.useCallback)((0,i.default)((function*(){try{var e=yield(0,u.iosReadGalleryPermission)("readWrite");d(e);var n=yield(0,u.iosReadGalleryPermission)("addOnly");y(n)}catch(e){console.error("[Gallery][Permission] can't read actual permission")}})),[]),P=(0,a.useCallback)((0,i.default)((function*(){var e=yield l.PermissionsAndroid.check("android.permission.READ_EXTERNAL_STORAGE"),n=yield l.PermissionsAndroid.check("android.permission.WRITE_EXTERNAL_STORAGE");console.log("isReadPermissionGranted ",e),d(e?"granted":"denied"),y(n?"granted":"denied")})),[]),S=(0,a.useCallback)((0,i.default)((function*(){var e=yield l.PermissionsAndroid.request(l.PermissionsAndroid.PERMISSIONS.READ_EXTERNAL_STORAGE);console.log("status ",e),d("granted"===e?"granted":"denied")})),[]),j=(0,a.useCallback)((0,i.default)((function*(){x(!0);var e=yield l.PermissionsAndroid.request(l.PermissionsAndroid.PERMISSIONS.WRITE_EXTERNAL_STORAGE);return y("granted"===e?"granted":"denied"),x(!1),"granted"===e?"granted":"denied"})),[]),k=(0,a.useCallback)((0,i.default)((function*(){x(!0),s.isIOS?yield b():yield P(),x(!1)})),[P,b]),O=(0,a.useCallback)((0,i.default)((function*(){x(!0),s.isIOS?yield b():yield S(),x(!1)})),[S,b]),C=(0,a.useCallback)((0,i.default)((function*(){try{x(!0);var e=yield(0,u.iosRequestReadWriteGalleryPermission)();d(e),y(e)}catch(e){console.error("[Gallery][Permission] can't request camera roll permission")}finally{x(!1)}})),[]),_=(0,a.useCallback)((0,i.default)((function*(){try{x(!0);var e=yield(0,u.iosRequestAddOnlyGalleryPermission)();return d(e),y(e),e}catch(e){return console.error("[Gallery][Permission] can't request camera roll write permission"),"denied"}finally{x(!1)}})),[]),w=(0,a.useCallback)((0,i.default)((function*(){return s.isAndroid?yield j():yield _()})),[j,_]);return(0,a.useEffect)((function(){n&&(c||v||!n||O())}),[n,O,v,c]),(0,a.useEffect)((function(){var e,n=l.AppState.addEventListener("change",(e=(0,i.default)((function*(e){"active"===e&&(yield k())})),function(n){return e.apply(this,arguments)}));return function(){n.remove()}}),[k]),(0,a.useEffect)((function(){s.isIOS&&n&&c&&"not-determined"===c&&!v&&C().then((function(e){}))}),[n,v,c,C]),(0,a.useEffect)((function(){!s.isIOS||v||n||b()}),[n,b,v]),{refreshPermissions:k,readPermissionStatus:c,writePermissionStatus:m,requestGalleryWritePermission:w,isLoading:v}}},84561:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.TitleText=n.DynamicHeaderModal=n.DynamicHeader=void 0;var i,o,a,l,u,s=r(t(19452)),c=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=y(n);if(t&&t.has(e))return t.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(t(84481)),d=t(92571),f=t(4007),p=t(25277),m=t(33823);function y(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(y=function(e){return e?t:n})(e)}var g=f.styled.View(i||(i=(0,s.default)(["\n  background-color: ",";\n  align-items: center;\n  justify-content: space-between;\n  flex-direction: row;\n  position: relative;\n  border-bottom-width: ",";\n  border-bottom-color: #ebebeb;\n  width: 100%;\n"])),(function(e){return e.theme.backgroundColor}),(function(e){return e.withDivider?"1px":0})),h=n.TitleText=f.styled.Text(o||(o=(0,s.default)(["\n  font-size: 18px;\n  color: ",";\n  text-align: center;\n  font-family: ",";\n"])),(function(e){return e.color||e.theme.grey1}),f.Fonts.Bold),v=d.StyleSheet.create({middleWrapper:{alignItems:"center",justifyContent:"center",flex:1,flexGrow:1,flexShrink:1,flexBasis:"100%"},icon:{width:24,height:24,paddingHorizontal:16,marginRight:12},rightBtn:{width:60,height:"100%",paddingRight:16,justifyContent:"center",alignItems:"flex-end"}}),x=f.styled.TouchableOpacity(a||(a=(0,s.default)(["\n  width: 60px;\n  height: 100%;\n  justify-content: center;\n  padding-left: 16px;\n"]))),b=f.styled.Image(l||(l=(0,s.default)(["\n  width: 24px;\n  height: 24px;\n  tint-color: ",";\n"])),(function(e){return e.theme.grey2})),P=f.styled.View(u||(u=(0,s.default)(["\n  width: 60px;\n  height: 100%;\n  flex-direction: row;\n  align-items: center;\n"])));n.DynamicHeader=(0,c.memo)((function(e){var n=e.renderLeftComponent,t=e.renderMiddleComponent,r=e.renderRightComponent,i=e.title,o=e.titleProps,a=void 0===o?{}:o,l=e.withDivider,u=void 0===l||l,s=e.icon,y=e.contentContainerStyle,S=e.onBack,j=(0,c.useCallback)((function(){return n||(0,m.jsx)(x,{onPress:S||f.goBack,children:(0,m.jsx)(b,{source:s||p.IC_OUTLINED_BACKWARD})})}),[n,S,s]),k=(0,c.useCallback)((function(){return i?(0,m.jsx)(h,Object.assign({},a,{numberOfLines:1,children:i})):t||null}),[t,i,a]),O=(0,c.useCallback)((function(){return r||(0,m.jsx)(P,{})}),[r]);return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(g,{withDivider:u,style:y,children:[j(),(0,m.jsx)(d.View,{style:v.middleWrapper,children:k()}),O()]})})})),n.DynamicHeaderModal=(0,c.memo)((function(e){var n=e.renderLeftComponent,t=e.renderMiddleComponent,r=e.renderRightComponent,i=e.title,o=e.titleProps,a=void 0===o?{}:o,l=e.withDivider,u=void 0===l||l,s=e.icon,p=e.iconRight,y=e.rightPress,P=e.contentContainerStyle,S=(0,c.useCallback)((function(){return n||(s?(0,m.jsx)(x,{onPress:f.goBack,children:(0,m.jsx)(b,{source:s})}):(0,m.jsx)(x,{}))}),[n,s]),j=(0,c.useCallback)((function(){return i?(0,m.jsx)(h,Object.assign({},a,{numberOfLines:1,children:i})):t||null}),[t,i,a]),k=(0,c.useCallback)((function(){return r||(p?(0,m.jsx)(d.TouchableOpacity,{style:v.rightBtn,onPress:y,children:(0,m.jsx)(b,{source:p})}):(0,m.jsx)(x,{}))}),[r]);return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(g,{withDivider:u,style:P,children:[S(),(0,m.jsx)(d.View,{style:v.middleWrapper,children:j()}),k()]})})}))},60694:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CameraRollScreen=void 0;var i,o,a,l,u=r(t(19452)),s=r(t(27424)),c=t(84481),d=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=x(n);if(t&&t.has(e))return t.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(t(46763)),f=t(25200),p=t(91087),m=t(4007),y=t(80810),g=t(84561),h=t(25277),v=t(33823);function x(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(x=function(e){return e?t:n})(e)}var b={code:"function anonymous(){const{aTop}=this.__closure;return{paddingTop:aTop.value};}"},P=n.CameraRollScreen=(0,c.memo)((function(){var e,n=(0,f.useAnimatedSafeAreaInsets)().aTop,t=(0,m.useNavigationParams)().onSubmit,r=(0,c.useState)([]),i=(0,s.default)(r,2),o=i[0],a=(i[1],(0,d.useAnimatedStyle)(((e=function(){return{paddingTop:n.value}}).__closure={aTop:n},e.__initData=b,e.__workletHash=9978501313055,e))),l=(0,c.useCallback)((function(e){t(e),(0,m.goBack)()}),[]);return(0,v.jsx)(p.ScreenWrapper,{children:(0,v.jsxs)(S,{style:a,children:[(0,v.jsx)(g.DynamicHeader,{renderLeftComponent:(0,v.jsx)(j,{onPress:m.goBack,children:(0,v.jsx)(k,{source:h.Icons.Outlined.X_MARK})}),renderMiddleComponent:(0,v.jsx)(O,{children:"Select a background"})}),(0,v.jsx)(y.CameraRollPicker,{isBottomSheet:!1,onSelectImage:l,selected:o,isMarked:!1})]})})})),S=(0,m.styled)(d.default.View)(i||(i=(0,u.default)(["\n  background-color: #fff;\n  flex: 1;\n"]))),j=m.styled.TouchableOpacity(o||(o=(0,u.default)(["\n  padding: 16px;\n"]))),k=m.styled.Image(a||(a=(0,u.default)(["\n  width: 24px;\n"]))),O=m.styled.Text(l||(l=(0,u.default)(["\n  font-family: ",";\n  font-weight: 700;\n  font-size: 20px;\n  text-align: center;\n  color: ",";\n"])),m.Fonts.Regular,(function(e){return e.theme.neutral1}));n.default=P}}]);//# sourceMappingURL=src_screens_CameraRollScreen_index_tsx.chunk.bundle.map?platform=android