{"version":3,"file":"src_screens_BaseDriveScreen_index_tsx.chunk.bundle","mappings":"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","sources":["webpack:///./node_modules/react-native-iphone-x-helper/index.js","webpack:///./src/components/HeaderClose.tsx","webpack:///./src/screens/BaseDriveScreen/index.tsx"],"sourcesContent":["import { Dimensions, Platform, StatusBar } from 'react-native';\n\nexport function isIphoneX() {\n    const dimen = Dimensions.get('window');\n    return (\n        Platform.OS === 'ios' &&\n        !Platform.isPad &&\n        !Platform.isTVOS &&\n        ((dimen.height === 780 || dimen.width === 780)\n          || (dimen.height === 812 || dimen.width === 812)\n          || (dimen.height === 844 || dimen.width === 844)\n          || (dimen.height === 896 || dimen.width === 896)\n          || (dimen.height === 926 || dimen.width === 926))\n    );\n}\n\nexport function ifIphoneX(iphoneXStyle, regularStyle) {\n    if (isIphoneX()) {\n        return iphoneXStyle;\n    }\n    return regularStyle;\n}\n\nexport function getStatusBarHeight(safe) {\n    return Platform.select({\n        ios: ifIphoneX(safe ? 44 : 30, 20),\n        android: StatusBar.currentHeight,\n        default: 0\n    });\n}\n\nexport function getBottomSpace() {\n    return isIphoneX() ? 34 : 0;\n}\n","import React, {memo, ReactElement} from 'react';\nimport {styled} from '@true/core';\nimport {Fonts, goBack} from '@true/core';\nimport {Icons} from '@true/asset';\n\nconst Container = styled.View<{withDivider?: boolean}>`\n  height: ${p => p.theme.statusHeight + 56}px;\n  background-color: ${p => p.theme.backgroundColor};\n  padding-top: ${p => p.theme.statusHeight}px;\n  flex-direction: row;\n  align-items: center;\n  border-bottom-width: ${p => (p.withDivider ? 1 : 0)}px;\n  border-bottom-color: ${p => p.theme.grey5}50;\n`;\n\nconst Center = styled.View`\n  flex: 1;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n  padding-left: ${16}px;\n`;\n\nconst Right = styled.TouchableOpacity`\n  width: ${60}px;\n  height: 100%;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  padding-right: ${16}px;\n`;\n\nconst Icon = styled.Image`\n  width: ${24}px;\n  height: ${24}px;\n  tint-color: ${p => p.theme.grey2};\n`;\n\nconst BannerText = styled.Text`\n  font-size: ${18}px;\n  color: ${p => p.theme.grey1};\n  font-family: ${Fonts.Bold};\n`;\n\ninterface Props {\n  title: string;\n  withDivider?: boolean;\n  right?: ReactElement;\n}\n\nexport const HeaderClose = memo(function HeaderClose(props: Props) {\n  const {title, withDivider} = props;\n  return (\n    <Container withDivider={withDivider}>\n      <Center>\n        <BannerText numberOfLines={1}>{title}</BannerText>\n      </Center>\n      <Right onPress={goBack}>\n        <Icon source={Icons.Outlined.X_MARK} />\n      </Right>\n    </Container>\n  );\n});\n","import React, {memo, useCallback, useMemo} from 'react';\nimport {WebView as RNWebView} from 'react-native-webview';\nimport {ActivityIndicator, Alert, View} from 'react-native';\nimport {getBottomSpace, getStatusBarHeight} from 'react-native-iphone-x-helper';\nimport { useNavigationParams } from '@true/core';\nimport { Core, Fetch } from '@true/core';\nimport { goBack } from '@true/core';\nimport { HeaderClose } from \"@/components/HeaderClose\";\n\nexport interface BaseDriveFile {\n  ext: string;\n  fid: string;\n  from_base_drive: 0 | 1;\n  is_image: 0 | 1;\n  metatype: 'base';\n  name: string;\n  preview: string; // url\n  refid: string; //number\n  size: number;\n  src: string;\n}\n\nconst LoadingIndicator = (\n  <ActivityIndicator\n    size=\"large\"\n    style={{\n      position: 'absolute',\n      zIndex: 1,\n      top: 16 + getStatusBarHeight(true),\n      right: 16,\n    }}\n  />\n);\n\nconst injectedJavascript = `(function() {\n  parent = window;\n  window.postMessage = function(data) {\n    window.ReactNativeWebView.postMessage(JSON.stringify(data));\n  };\n})()`;\n\nconst renderLoading = () => LoadingIndicator;\n\nexport interface BaseDriveScreenParams {\n  multi?: number;\n  onFiles?: (files: BaseDriveFile[]) => any;\n}\n\nexport const BaseDriveScreen = memo(function BaseDriveScreen() {\n  const {multi = 1, onFiles,} = useNavigationParams<BaseDriveScreenParams>()\n\n  const source = useMemo(() => {\n    const baseToken =\n      '_uuid' +\n      Math.random()\n        .toString(32)\n        .substring(2);\n    const params = {\n      access_token: Core.accessToken,\n      __code: 'native',\n      multi: multi,\n      ext: 1,\n      base_token: baseToken,\n    };\n\n    const extParams = Object.keys(params)\n      // @ts-ignore\n      .map(key => `${key}=${params[key]}`)\n      .join('&');\n\n    const uri = Fetch.__getRealUrl(\n      `@drive/picker?${extParams}&base_domain=https%3A%2F%2Fmessage.${Core.sysUrl}`,\n    );\n\n    return {uri};\n  }, [multi]);\n\n  const onMessage = useCallback((event:any) => {\n    try {\n      const data = JSON.parse(event.nativeEvent.data);\n      const files = data.files as BaseDriveFile[];\n      if (files?.length) {\n        onFiles?.(files);\n        goBack()\n      }\n\n    } catch (e:any) {\n      Alert.alert(e.toString(), \"\")\n    }\n  }, [onFiles]);\n\n  return (\n    <View style={{flex:1}}>\n      <HeaderClose title={'Base Drive'}/>\n      <RNWebView\n        source={source}\n        onMessage={onMessage}\n        renderLoading={renderLoading}\n        domStorageEnabled={true}\n        allowsInlineMediaPlayback={true}\n        sharedCookiesEnabled={false}\n        thirdPartyCookiesEnabled={false}\n        startInLoadingState={true}\n        injectedJavaScriptBeforeContentLoaded={injectedJavascript}\n      />\n      <View style={{width: '100%', height: getBottomSpace()}}/>\n    </View>\n  );\n});\n\nexport default BaseDriveScreen;\n"],"names":["isIphoneX","safe","Platform","select","ios","ifIphoneX","android","StatusBar","currentHeight","default","_reactNative","require","dimen","Dimensions","get","OS","isPad","isTVOS","height","width","iphoneXStyle","regularStyle","_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_react","e","r","__esModule","t","_getRequireWildcardCache","has","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","_interopRequireWildcard","_core","_asset","_jsxRuntime","WeakMap","Container","styled","View","_taggedTemplateLiteralLoose2","p","theme","statusHeight","backgroundColor","withDivider","grey5","Center","Right","TouchableOpacity","Icon","Image","grey2","BannerText","Text","grey1","Fonts","Bold","exports","memo","props","title","jsxs","children","jsx","numberOfLines","onPress","goBack","source","Icons","Outlined","X_MARK","_reactNativeWebview","_reactNativeIphoneXHelper","_HeaderClose","LoadingIndicator","ActivityIndicator","size","style","position","zIndex","top","getStatusBarHeight","right","renderLoading","BaseDriveScreen","_useNavigationParams","useNavigationParams","_useNavigationParams$","multi","onFiles","useMemo","baseToken","Math","random","toString","substring","params","access_token","Core","accessToken","__code","ext","base_token","extParams","keys","map","key","join","uri","Fetch","__getRealUrl","sysUrl","onMessage","useCallback","event","files","JSON","parse","nativeEvent","data","length","Alert","alert","flex","HeaderClose","WebView","domStorageEnabled","allowsInlineMediaPlayback","sharedCookiesEnabled","thirdPartyCookiesEnabled","startInLoadingState","injectedJavaScriptBeforeContentLoaded","getBottomSpace"],"sourceRoot":""}