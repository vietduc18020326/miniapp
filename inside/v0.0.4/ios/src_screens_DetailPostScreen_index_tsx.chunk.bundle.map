{"version":3,"file":"src_screens_DetailPostScreen_index_tsx.chunk.bundle","mappings":"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","sources":["webpack:///./src/screens/DetailPostScreen/index.tsx"],"sourcesContent":["import React, {memo, useCallback, useEffect, useMemo} from 'react';\nimport {Avatar, Comment, FullScreenWrapper, TimeAgo} from '@true/ui';\nimport {\n  Fonts,\n  goBack,\n  styled,\n  useAsyncFn,\n  useMe,\n  useNavigationParams,\n  useUser,\n} from '@true/core';\nimport Animated, {\n  Extrapolation,\n  interpolate,\n  useAnimatedStyle,\n  useSharedValue,\n  useWorkletCallback,\n} from 'react-native-reanimated';\nimport {\n  Image,\n  NativeScrollEvent,\n  NativeSyntheticEvent,\n  View,\n} from 'react-native';\nimport {Icons} from '@true/asset';\nimport {useAnimatedSafeAreaInsets} from 'react-native-safe-area-context';\nimport {globalStyles} from '@/utils/globalStyle';\nimport {PostThumbnail} from '@/components/PostThumbnail';\nimport {useUpdates} from '@/store/updates';\nimport TypePost from '@/services/TypePostService';\nimport {FlexCenter, STextDivider} from '@/utils/helper';\nimport {requestUpdatePost} from '@/store/updates/function';\nimport {setActiveUpdate} from '@/zustand/activeUpdate';\nimport {openActionPostScreen} from '@/utils';\n\nexport interface DetailPostScreenParams {\n  id: number;\n}\n\nexport const DetailPostScreen = memo(function () {\n  const {id} = useNavigationParams<DetailPostScreenParams>();\n  const data = useUpdates(id);\n  const user = useUser(data?.user_id || 0);\n  const {aTop} = useAnimatedSafeAreaInsets();\n  const animatedPaddingTop = useAnimatedStyle(() => ({\n    paddingTop: aTop.value,\n  }));\n  const scroll_x = useSharedValue(0);\n\n  const onContentScroll = useWorkletCallback(\n    (event: NativeSyntheticEvent<NativeScrollEvent>) => {\n      const scrollValue = event.nativeEvent.contentOffset.y;\n      scroll_x.value = scrollValue;\n    },\n    [],\n  );\n\n  const time = useMemo(() => {\n    return data?.since || 0;\n  }, []);\n\n  const animatedTextHeaderStyle = useAnimatedStyle(() => {\n    const info_header_opacity = interpolate(scroll_x.value, [0, 120], [0, 1], {\n      extrapolateRight: Extrapolation.CLAMP,\n    });\n    return {\n      opacity: info_header_opacity,\n    };\n  });\n\n  const openActionUpdate = useCallback(() => {\n    const hid = data?.attachment?.hid || data?.hid || '';\n    const user_id = data?.user_id || 0;\n    openActionPostScreen();\n    setActiveUpdate(data?.truetype, id, user_id, hid);\n  }, []);\n\n  const [{loading: firstLoading, error: firstError}, loadFirst] = useAsyncFn(\n    () => requestUpdatePost({update_id: id}),\n    [id],\n  );\n  const [{loading: refreshing, error: refreshError}, refresh] = useAsyncFn(\n    () => requestUpdatePost({update_id: id}),\n    [id],\n  );\n\n  useEffect(() => {\n    loadFirst().then();\n  }, []);\n\n  return (\n    <FullScreenWrapper>\n      <Comment.Provider\n        appName={'inside'}\n        type={'comment'}\n        hid={data?.attachment?.hid || data?.hid || ''}\n        token={data?.attachment?.token || data?.token || ''}>\n        <SHeader style={animatedPaddingTop}>\n          <FlexCenter>\n            <SIconBack onPress={goBack}>\n              <Image source={Icons.Outlined.CHEVRON_LEFT} />\n            </SIconBack>\n            <SAnimateInfo style={animatedTextHeaderStyle}>\n              <Avatar size={32} userKey={data?.user_id || 0} />\n              <View style={globalStyles.ml8}>\n                <STextUser>{user?.name}</STextUser>\n                <FlexCenter>\n                  {data?.truetype !== 'update' ? (\n                    <>\n                      <SIconSmall>\n                        <SImage\n                          source={TypePost.getTypePostImage(\n                            data?.truetype || 'update',\n                          )}\n                        />\n                      </SIconSmall>\n                      <STextTime\n                        style={globalStyles.ml4}>{`${TypePost.getReactionText(\n                        data?.truetype || 'update',\n                      )}`}</STextTime>\n                      <STextDivider> | </STextDivider>\n                    </>\n                  ) : null}\n                  <STextTime>\n                    <TimeAgo time={time * 1000} />\n                  </STextTime>\n                </FlexCenter>\n              </View>\n            </SAnimateInfo>\n          </FlexCenter>\n          <SIconOption onPress={openActionUpdate}>\n            <Image source={Icons.Outlined.HORIZONTAL_3DOTS} />\n          </SIconOption>\n        </SHeader>\n        <Comment.List\n          refreshing={refreshing}\n          onLoadData={refresh}\n          ListHeaderComponent={<PostThumbnail isInFeed={false} id={id} />}\n          onScroll={onContentScroll}\n          appName={'inside'}\n        />\n        <Comment.Input />\n        <Comment.BottomSheet />\n      </Comment.Provider>\n    </FullScreenWrapper>\n  );\n});\n\nconst SHeader = styled(Animated.View)`\n  background-color: white;\n  padding: 8px 16px 8px 0;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n`;\nconst SIconBack = styled.TouchableOpacity`\n  width: 48px;\n  height: 48px;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst STextUser = styled.Text`\n  font-family: ${Fonts.Regular};\n\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 16px;\n  color: #242424;\n`;\nconst STextTime = styled.Text`\n  font-family: ${Fonts.Regular};\n\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n  color: #666666;\n`;\nconst SAnimateInfo = styled(Animated.View)`\n  flex-direction: row;\n  align-items: center;\n`;\nconst SIconOption = styled.TouchableOpacity.attrs(p => ({\n  hitSlop: {top: 8, bottom: 8, left: 8, right: 8},\n}))`\n  width: 24px;\n  height: 24px;\n  align-items: center;\n  justify-content: flex-start;\n`;\nconst SIconSmall = styled.View`\n  width: 16px;\n  height: 16px;\n  align-items: center;\n  justify-content: center;\n`;\nconst SImage = styled.Image`\n  tint-color: #666666;\n  width: 16px;\n  height: 16px;\n`;\nexport default DetailPostScreen;\n"],"names":["_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_templateObject6","_templateObject7","_templateObject8","_react","_interopRequireWildcard","require","_ui","_core","_reactNativeReanimated","_reactNative","_asset","_reactNativeSafeAreaContext","_globalStyle","_PostThumbnail","_updates","_TypePostService","_interopRequireDefault","_helper","_function","_activeUpdate","_utils","_jsxRuntime","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","_worklet_9978501313055_init_data","code","_worklet_4428087754035_init_data","_worklet_4966309020424_init_data","DetailPostScreen","exports","memo","_data$attachment2","_data$attachment3","anonymous","id","useNavigationParams","data","useUpdates","user","useUser","user_id","aTop","useAnimatedSafeAreaInsets","animatedPaddingTop","useAnimatedStyle","paddingTop","value","__closure","__initData","__workletHash","scroll_x","useSharedValue","onContentScroll","useWorkletCallback","event","scrollValue","nativeEvent","contentOffset","y","time","useMemo","since","animatedTextHeaderStyle","opacity","interpolate","extrapolateRight","Extrapolation","CLAMP","openActionUpdate","useCallback","_data$attachment","hid","attachment","openActionPostScreen","setActiveUpdate","truetype","_useAsyncFn","useAsyncFn","requestUpdatePost","update_id","_useAsyncFn2","_slicedToArray2","_useAsyncFn2$","loadFirst","loading","error","_useAsyncFn3","_useAsyncFn4","_useAsyncFn4$","refreshing","refresh","useEffect","then","jsx","FullScreenWrapper","children","jsxs","Comment","Provider","appName","type","token","SHeader","style","FlexCenter","SIconBack","onPress","goBack","Image","source","Icons","Outlined","CHEVRON_LEFT","SAnimateInfo","Avatar","size","userKey","View","globalStyles","ml8","STextUser","name","Fragment","SIconSmall","SImage","TypePost","getTypePostImage","STextTime","ml4","getReactionText","STextDivider","TimeAgo","SIconOption","HORIZONTAL_3DOTS","List","onLoadData","ListHeaderComponent","PostThumbnail","isInFeed","onScroll","Input","BottomSheet","styled","Animated","_taggedTemplateLiteralLoose2","TouchableOpacity","Text","Fonts","Regular","attrs","p","hitSlop","top","bottom","left","right"],"sourceRoot":""}