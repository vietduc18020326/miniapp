(self.webpackChunkInside=self.webpackChunkInside||[]).push([["src_screens_CameraRollScreen_index_tsx"],{80810:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.CameraRollPicker=void 0;var i,o,a,l,s,u,c=r(t(19452)),d=r(t(861)),f=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=C(n);if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,t&&t.set(e,r);return r}(t(84481)),p=t(92571),m=t(46842),y=r(t(15159)),g=t(4007),h=t(74186),v=t(8937),x=t(46763),b=t(94505),P=t(33823);function C(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(C=function(e){return e?t:n})(e)}var S=function(e){return e.Photos="Photos",e.Videos="Videos",e.All="All",e}(S||{}),A=(n.CameraRollPicker=(0,g.memoForwardRef)((function(e,n){var t=e.emptyText,r=e.groupName,i=e.onSelectImage,o=e.onSelectImages,a=e.selected,l=e.groupTypes,s=e.isMarked,u=e.isBottomSheet,c=(0,v.useGallery)({pageSize:24,groupName:r,groupTypes:l}),C=c.photos,S=c.loadNextPagePictures,T=c.hasNextPage,E=c.isLoadingNextPage,I=c.isLimited,D=(0,x.useSharedValue)(0),M=(0,f.useRef)(a),L=(0,f.useMemo)((function(){return u?h.BottomSheetFlatList:p.FlatList}),[u]),N=(0,g.useTheme)(),G=(0,b.useGalleryPermission)({autoRequestPermission:!0}),B=G.readPermissionStatus,W=(G.refreshPermissions,G.isLoading,(0,f.useMemo)((function(){return"granted"===B||"limited"===B}),[B]),(0,f.useCallback)((function(){p.ActionSheetIOS.showActionSheetWithOptions({options:["Cancel","Add more photos","Change setting permission"],cancelButtonIndex:0,userInterfaceStyle:"dark"==N.name?"dark":"light"},(function(e){0===e||(1===e?(0,m.iosRefreshGallerySelection)().then():2===e&&p.Linking.openSettings().then())}))}),[])),F=(0,f.useCallback)((function(e){var n,t,r=(null==(n=e.nativeEvent)||null==(t=n.layout)?void 0:t.width)||p.Dimensions.get("window").width;D.value=(r-3)/3}),[]),z=(0,f.useCallback)((function(e){if(i&&i(e),M.current){var n=(0,d.default)(M.current).filter((function(n){return"android"===p.Platform.OS?n.fileName!==e.fileName:n.url!==e.url}));n.length===M.current.length?M.current=[].concat((0,d.default)(M.current),[e]):M.current=n,null==o||o(M.current)}}),[i,o,M]);(0,f.useImperativeHandle)(n,(function(){return{onImagePress:z}}));var V=(0,f.useCallback)((function(e){var n=e.item,t=a.findIndex((function(e){return"android"===p.Platform.OS?e.fileName===n.fileName:e.url===n.url}));return(0,P.jsx)(y.default,{isMarked:s,isSelected:t,onSelectItem:z,photo:n,imageSize:D})}),[a,z,D]),q=(0,f.useMemo)((function(){return[{url:"add-media",date:new Date,isButton:!0}].concat(C)}),[C]),H=(0,f.useCallback)((function(){return T&&E?(0,P.jsx)(p.ActivityIndicator,{size:"large",color:"#007AFF",style:{alignSelf:"center"}}):null}),[T,E]);return(0,P.jsxs)(A,{onLayout:F,children:[I?(0,P.jsx)(_,{onPress:W,activeOpacity:.9,children:(0,P.jsxs)(w,{children:["Edit Permission Photos"," ",(0,P.jsx)(R,{children:"Change Permission"})]})}):null,C?(0,P.jsx)(L,{ListFooterComponent:H,renderItem:V,keyExtractor:k,data:q,extraData:C||a.length||D,onEndReachedThreshold:.01,onEndReached:(null==C?void 0:C.length)<24||!T?void 0:S,numColumns:3,ListEmptyComponent:(0,P.jsx)(O,{children:(0,P.jsx)(j,{children:t})})}):null]})})),g.styled.View(i||(i=(0,c.default)(["\n  flex: 1;\n  background-color: ",";\n"])),(function(e){return e.theme.backgroundColor}))),O=g.styled.View(o||(o=(0,c.default)(["\n  flex: 1;\n  justify-content: center;\n  background-color: ",";\n"])),(function(e){return e.theme.backgroundColor})),j=g.styled.Text(a||(a=(0,c.default)(["\n  color: ",";\n  font-size: 16px;\n  text-align: center;\n"])),(function(e){return e.theme.grey1})),k=function(e){return"camera-roll "+e.url},_=g.styled.TouchableOpacity(l||(l=(0,c.default)(["\n  background-color: rgba(240, 247, 255, 1);\n  padding: 6px 8px;\n  border: 1px solid rgba(224, 224, 224, 1);\n  margin-top: -5px;\n"]))),w=g.styled.Text(s||(s=(0,c.default)(["\n  font-family: ",";\n  \n  font-size: 13px;\n  line-height: 20px;\n  color: #242424;\n"])),g.Fonts.Regular),R=g.styled.Text(u||(u=(0,c.default)(["\n  font-family: ",";\n  \n  font-size: 13px;\n  line-height: 20px;\n  color: ",";\n  text-decoration: underline;\n  text-decoration-color: ",";\n"])),g.Fonts.Bold,(function(e){return e.theme.primaryColor}),(function(e){return e.theme.primaryColor}))},8937:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.useGallery=n.isIOS=n.isAndroid=n.isAboveIOS14=n.convertCameraRollPicturesToImageDtoType=void 0;var i=r(t(861)),o=r(t(17156)),a=r(t(27424)),l=t(46842),s=t(84481),u=t(92571),c=n.isIOS="ios"===u.Platform.OS,d=n.isAndroid="android"===u.Platform.OS,f=n.isAboveIOS14=c&&parseInt(u.Platform.Version,10)>=14,p=n.convertCameraRollPicturesToImageDtoType=function(e){return e.map((function(e){var n,t;return{url:e.node.image.uri,size:e.node.image.fileSize,fileName:e.node.image.filename,type:e.node.type,playableDuration:(null==e||null==(n=e.node)||null==(t=n.image)?void 0:t.playableDuration)||0}}))};n.useGallery=function(e){var n=e.pageSize,t=void 0===n?30:n,r=e.groupName,c=e.groupTypes,m=(0,s.useState)(!1),y=(0,a.default)(m,2),g=y[0],h=y[1],v=(0,s.useState)(!1),x=(0,a.default)(v,2),b=x[0],P=x[1],C=(0,s.useState)(!1),S=(0,a.default)(C,2),A=S[0],O=S[1],j=(0,s.useState)(!1),k=(0,a.default)(j,2),_=k[0],w=k[1],R=(0,s.useRef)(void 0),T=(0,s.useState)([]),E=(0,a.default)(T,2),I=E[0],D=E[1],M=(0,s.useState)(!1),L=(0,a.default)(M,2),N=L[0],G=L[1],B=(0,s.useRef)(!1),W=(0,s.useCallback)((0,o.default)((function*(){if(!(g||A||B.current))try{B.current=!0,R.current?O(!0):h(!0);var e=yield l.CameraRoll.getPhotos(Object.assign({first:t,after:R.current,assetType:"All",groupName:r,groupTypes:c},d&&{include:["filename","playableDuration"]})),n=e.edges,o=e.page_info,a=e.limited;a&&G(a);var s=p(n);D((function(e){return[].concat((0,i.default)(e||[]),(0,i.default)(s))})),R.current=o.end_cursor,w(o.has_next_page)}catch(e){console.error("useGallery getPhotos error:",e)}finally{h(!1),O(!1),B.current=!1}})),[R,r,c,t]),F=(0,s.useCallback)((0,o.default)((function*(){if(!B.current&&!b)try{P(!0),B.current=!0;var e=yield l.CameraRoll.getPhotos(Object.assign({first:t,assetType:"All",groupName:r,groupTypes:c,after:void 0},d&&{include:["filename","playableDuration"]})),n=e.edges,i=e.page_info,o=e.limited,a=p(n);D(a),o&&G(o),R.current=i.end_cursor,w(i.has_next_page)}catch(e){console.error("useGallery getNewPhotos error:",e)}finally{P(!1),B.current=!1}})),[t,r,c,b]),z=(0,s.useCallback)((0,o.default)((function*(){h(!0);try{R?O(!0):h(!0);var e=yield l.CameraRoll.getPhotos(Object.assign({first:t,after:"",assetType:"All",groupName:r,groupTypes:c},d&&{include:["playableDuration","filename"]})),n=e.edges,o=e.page_info,a=e.limited,s=p(n);D((0,i.default)(s)),a&&G(a),R.current=o.end_cursor,w(o.has_next_page)}catch(e){console.error("useGallery refresh error:",e)}finally{h(!1),O(!1)}})),[t,c,r]);return(0,s.useEffect)((function(){null!=I&&I.length||W().then()}),[I]),(0,s.useEffect)((function(){var e,n=u.AppState.addEventListener("change",(e=(0,o.default)((function*(e){"active"===e&&F().then()})),function(n){return e.apply(this,arguments)}));return function(){n.remove()}}),[F]),(0,s.useEffect)((function(){var e;return f&&(e=l.cameraRollEventEmitter.addListener("onLibrarySelectionChange",(function(e){F().then()}))),function(){f&&e&&e.remove()}}),[F]),{refresh:z,photos:I,loadNextPagePictures:W,isLoading:g,isLoadingNextPage:A,isReloading:b,hasNextPage:_,isLimited:N}}},94505:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.useGalleryPermission=void 0;var i=r(t(17156)),o=r(t(27424)),a=t(84481),l=t(92571),s=t(46842),u=t(8937);n.useGalleryPermission=function(e){var n=e.autoRequestPermission,t=(0,a.useState)(),r=(0,o.default)(t,2),c=r[0],d=r[1],f=(0,a.useState)(),p=(0,o.default)(f,2),m=p[0],y=p[1],g=(0,a.useState)(!1),h=(0,o.default)(g,2),v=h[0],x=h[1],b=(0,a.useCallback)((0,i.default)((function*(){try{var e=yield(0,s.iosReadGalleryPermission)("readWrite");d(e);var n=yield(0,s.iosReadGalleryPermission)("addOnly");y(n)}catch(e){console.error("[Gallery][Permission] can't read actual permission")}})),[]),P=(0,a.useCallback)((0,i.default)((function*(){var e=yield l.PermissionsAndroid.check("android.permission.READ_EXTERNAL_STORAGE"),n=yield l.PermissionsAndroid.check("android.permission.WRITE_EXTERNAL_STORAGE");console.log("isReadPermissionGranted ",e),d(e?"granted":"denied"),y(n?"granted":"denied")})),[]),C=(0,a.useCallback)((0,i.default)((function*(){var e=yield l.PermissionsAndroid.request(l.PermissionsAndroid.PERMISSIONS.READ_EXTERNAL_STORAGE);console.log("status ",e),d("granted"===e?"granted":"denied")})),[]),S=(0,a.useCallback)((0,i.default)((function*(){x(!0);var e=yield l.PermissionsAndroid.request(l.PermissionsAndroid.PERMISSIONS.WRITE_EXTERNAL_STORAGE);return y("granted"===e?"granted":"denied"),x(!1),"granted"===e?"granted":"denied"})),[]),A=(0,a.useCallback)((0,i.default)((function*(){x(!0),u.isIOS?yield b():yield P(),x(!1)})),[P,b]),O=(0,a.useCallback)((0,i.default)((function*(){x(!0),u.isIOS?yield b():yield C(),x(!1)})),[C,b]),j=(0,a.useCallback)((0,i.default)((function*(){try{x(!0);var e=yield(0,s.iosRequestReadWriteGalleryPermission)();d(e),y(e)}catch(e){console.error("[Gallery][Permission] can't request camera roll permission")}finally{x(!1)}})),[]),k=(0,a.useCallback)((0,i.default)((function*(){try{x(!0);var e=yield(0,s.iosRequestAddOnlyGalleryPermission)();return d(e),y(e),e}catch(e){return console.error("[Gallery][Permission] can't request camera roll write permission"),"denied"}finally{x(!1)}})),[]),_=(0,a.useCallback)((0,i.default)((function*(){return u.isAndroid?yield S():yield k()})),[S,k]);return(0,a.useEffect)((function(){n&&(c||v||!n||O())}),[n,O,v,c]),(0,a.useEffect)((function(){var e,n=l.AppState.addEventListener("change",(e=(0,i.default)((function*(e){"active"===e&&(yield A())})),function(n){return e.apply(this,arguments)}));return function(){n.remove()}}),[A]),(0,a.useEffect)((function(){u.isIOS&&n&&c&&"not-determined"===c&&!v&&j().then((function(e){}))}),[n,v,c,j]),(0,a.useEffect)((function(){!u.isIOS||v||n||b()}),[n,b,v]),{refreshPermissions:A,readPermissionStatus:c,writePermissionStatus:m,requestGalleryWritePermission:_,isLoading:v}}},84561:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.TitleText=n.DynamicHeaderModal=n.DynamicHeader=void 0;var i,o,a,l,s,u=r(t(19452)),c=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=y(n);if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,t&&t.set(e,r);return r}(t(84481)),d=t(92571),f=t(4007),p=t(25277),m=t(33823);function y(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(y=function(e){return e?t:n})(e)}var g=f.styled.View(i||(i=(0,u.default)(["\n  background-color: ",";\n  align-items: center;\n  justify-content: space-between;\n  flex-direction: row;\n  position: relative;\n  border-bottom-width: ",";\n  border-bottom-color:#EBEBEB ;\n  width: 100%;\n"])),(function(e){return e.theme.backgroundColor}),(function(e){return e.withDivider?"1px":0})),h=n.TitleText=f.styled.Text(o||(o=(0,u.default)(["\n  font-size: 18px;\n  color: ",";\n  text-align: center;\n  font-family: ",";\n"])),(function(e){return e.color||e.theme.grey1}),f.Fonts.Bold),v=d.StyleSheet.create({middleWrapper:{alignItems:"center",justifyContent:"center",flex:1,flexGrow:1,flexShrink:1,flexBasis:"100%"},icon:{width:24,height:24,paddingHorizontal:16,marginRight:12},rightBtn:{width:60,height:"100%",paddingRight:16,justifyContent:"center",alignItems:"flex-end"}}),x=f.styled.TouchableOpacity(a||(a=(0,u.default)(["\n  width: 60px;\n  height: 100%;\n  justify-content: center;\n  padding-left: 16px;\n"]))),b=f.styled.Image(l||(l=(0,u.default)(["\n  width: 24px;\n  height: 24px;\n  tint-color: ","\n"])),(function(e){return e.theme.grey2})),P=f.styled.View(s||(s=(0,u.default)(["\n  width: 60px;\n  height: 100%;\n  flex-direction: row;\n  align-items: center;\n"])));n.DynamicHeader=(0,c.memo)((function(e){var n=e.renderLeftComponent,t=e.renderMiddleComponent,r=e.renderRightComponent,i=e.title,o=e.titleProps,a=void 0===o?{}:o,l=e.withDivider,s=void 0===l||l,u=e.icon,y=e.contentContainerStyle,C=e.onBack,S=(0,c.useCallback)((function(){return n||(0,m.jsx)(x,{onPress:C||f.goBack,children:(0,m.jsx)(b,{source:u||p.IC_OUTLINED_BACKWARD})})}),[n,C,u]),A=(0,c.useCallback)((function(){return i?(0,m.jsx)(h,Object.assign({},a,{numberOfLines:1,children:i})):t||null}),[t,i,a]),O=(0,c.useCallback)((function(){return r||(0,m.jsx)(P,{})}),[r]);return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(g,{withDivider:s,style:y,children:[S(),(0,m.jsx)(d.View,{style:v.middleWrapper,children:A()}),O()]})})})),n.DynamicHeaderModal=(0,c.memo)((function(e){var n=e.renderLeftComponent,t=e.renderMiddleComponent,r=e.renderRightComponent,i=e.title,o=e.titleProps,a=void 0===o?{}:o,l=e.withDivider,s=void 0===l||l,u=e.icon,p=e.iconRight,y=e.rightPress,P=e.contentContainerStyle,C=(0,c.useCallback)((function(){return n||(u?(0,m.jsx)(x,{onPress:f.goBack,children:(0,m.jsx)(b,{source:u})}):(0,m.jsx)(x,{}))}),[n,u]),S=(0,c.useCallback)((function(){return i?(0,m.jsx)(h,Object.assign({},a,{numberOfLines:1,children:i})):t||null}),[t,i,a]),A=(0,c.useCallback)((function(){return r||(p?(0,m.jsx)(d.TouchableOpacity,{style:v.rightBtn,onPress:y,children:(0,m.jsx)(b,{source:p})}):(0,m.jsx)(x,{}))}),[r]);return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(g,{withDivider:s,style:P,children:[C(),(0,m.jsx)(d.View,{style:v.middleWrapper,children:S()}),A()]})})}))},60694:function(e,n,t){var r=t(64836);Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CameraRollScreen=void 0;var i,o,a,l,s=r(t(19452)),u=r(t(27424)),c=t(84481),d=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=x(n);if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,t&&t.set(e,r);return r}(t(46763)),f=t(25200),p=t(91087),m=t(4007),y=t(80810),g=t(25277),h=t(84561),v=t(33823);function x(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(x=function(e){return e?t:n})(e)}var b={code:"function anonymous(){const{aTop}=this.__closure;return{paddingTop:aTop.value};}",location:"/Users/phamduc/inside/src/screens/CameraRollScreen/index.tsx",sourceMap:'{"version":3,"names":["anonymous","aTop","__closure","paddingTop","value"],"sources":["/Users/phamduc/inside/src/screens/CameraRollScreen/index.tsx"],"mappings":"AAuB0C,SAAAA,UAAA,QAAAC,IAAA,OAAAC,SAAA,OAAO,CAC7CC,UAAU,CAAEF,IAAI,CAACG,KACnB,CAAC"}',version:"3.5.4"},P=n.CameraRollScreen=(0,c.memo)((function(){var e,n,r=(0,f.useAnimatedSafeAreaInsets)().aTop,i=(0,m.useNavigationParams)().onSubmit,o=(0,c.useState)([]),a=(0,u.default)(o,2),l=a[0],s=(a[1],(0,d.useAnimatedStyle)((e=[new t.g.Error,-2,-27],(n=function(){return{paddingTop:r.value}}).__closure={aTop:r},n.__initData=b,n.__workletHash=9978501313055,n.__stackDetails=e,n))),x=(0,c.useCallback)((function(e){i(e),(0,m.goBack)()}),[]);return(0,v.jsx)(p.ScreenWrapper,{children:(0,v.jsxs)(C,{style:s,children:[(0,v.jsx)(h.DynamicHeader,{renderLeftComponent:(0,v.jsx)(S,{onPress:m.goBack,children:(0,v.jsx)(A,{source:g.IC_OUTLINED_CLOSE})}),renderMiddleComponent:(0,v.jsx)(O,{children:"Select a background"})}),(0,v.jsx)(y.CameraRollPicker,{isBottomSheet:!1,onSelectImage:x,selected:l,isMarked:!1})]})})})),C=(0,m.styled)(d.default.View)(i||(i=(0,s.default)(["\n  background-color: #fff;\n  flex: 1;\n"]))),S=m.styled.TouchableOpacity(o||(o=(0,s.default)(["\n  padding: 16px;\n"]))),A=m.styled.Image(a||(a=(0,s.default)(["\n  width: 24px;\n"]))),O=m.styled.Text(l||(l=(0,s.default)(["\n  font-family: ",";\n  \n  font-weight: 700;\n  font-size: 20px;\n  text-align: center;\n  color: #242424;\n"])),m.Fonts.Regular);n.default=P}}]);//# sourceMappingURL=src_screens_CameraRollScreen_index_tsx.chunk.bundle.map?platform=ios