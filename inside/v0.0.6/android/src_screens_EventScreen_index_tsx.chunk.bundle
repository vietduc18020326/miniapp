(self.webpackChunkInside=self.webpackChunkInside||[]).push([["src_screens_EventScreen_index_tsx"],{83899:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.EventThumbnail=void 0;var a,i,s,u,o,l,d,c,f,v,p,h,y=r(n(19452)),b=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=a?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(84481)),g=n(4007),m=r(n(30381)),x=n(20349),j=n(75867),E=n(48764),k=r(n(82825)),O=n(73781),q=n(33823);function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}t.EventThumbnail=(0,b.memo)((function(e){var t=e.id,n=(0,j.useEvents)(t),r=(0,b.useMemo)((function(){var e=E.Buffer.from((null==n?void 0:n.cover)||"","base64").toString("utf-8");if(e){var t=JSON.parse(e);if(t&&t.image)return t}return null}),[null==n?void 0:n.cover]),a=(0,b.useCallback)((function(){(0,x.openDetailEventScreen)({id:t})}),[]),i=(0,b.useMemo)((function(){var e;return null==(e=(0,O.getChannels)((null==n?void 0:n.channel_id)||""))?void 0:e.name}),[]);return(0,q.jsx)(P,{children:(0,q.jsxs)(C,{onPress:a,children:[(0,q.jsxs)(T,{children:[(0,q.jsx)(D,{children:(0,q.jsx)(I,{children:i})}),(0,q.jsx)(S,{resizeMode:"cover",source:{uri:(null==r?void 0:r.image)||""}})]}),(0,q.jsxs)(_,{children:[(0,q.jsx)(F,{children:(0,m.default)(1e3*(null==n?void 0:n.time)).format("dddd, HH:mm DD/MM/YYYY")}),(0,q.jsx)(W,{children:null==n?void 0:n.name}),(0,q.jsxs)(M,{children:[(0,q.jsx)(Q,{children:(null==n?void 0:n.attendees.length)+" attendees"}),(0,q.jsx)(V,{}),(0,q.jsx)(Q,{children:null==n?void 0:n.address})]})]})]})})}));var P=g.styled.View(a||(a=(0,y.default)(["\n  background-color: transparent;\n"]))),C=g.styled.TouchableOpacity(i||(i=(0,y.default)(["\n  background-color: white;\n  border-radius: 8px;\n  border: 1px solid #ebebeb;\n  margin: 16px 16px 0 16px;\n  padding: 12px;\n"]))),T=g.styled.View(s||(s=(0,y.default)(["\n  width: 100%;\n"]))),S=(0,g.styled)(k.default)(u||(u=(0,y.default)(["\n  width: 100%;\n  height: 180px;\n  max-height: 180px;\n  border-radius: 8px;\n  background-color: #2a91d6;\n"]))),_=g.styled.View(o||(o=(0,y.default)(["\n  align-items: flex-start;\n  justify-content: center;\n"]))),M=g.styled.View(l||(l=(0,y.default)(["\n  flex-direction: row;\n  align-items: center;\n"]))),F=g.styled.Text(d||(d=(0,y.default)(["\n  color: ",";\n  font-family: ",";\n  font-size: 14px;\n  line-height: 20px;\n  margin-top: 8px;\n"])),(function(e){return e.theme.neutral2}),g.Fonts.Medium),W=g.styled.Text.attrs((function(e){return{numberOfLines:2}}))(c||(c=(0,y.default)(["\n  color: ",";\n  font-family: ",";\n  font-size: 16px;\n  line-height: 24px;\n  margin-top: 4px;\n"])),(function(e){return e.theme.neutral1}),g.Fonts.Regular),Q=g.styled.Text(f||(f=(0,y.default)(["\n  color: ",";\n  font-family: ",";\n  font-size: 12px;\n  line-height: 16px;\n  margin-top: 8px;\n"])),(function(e){return e.theme.neutral2}),g.Fonts.Medium),V=g.styled.View(v||(v=(0,y.default)(["\n  background-color: ",";\n  width: 4px;\n  height: 4px;\n  border-radius: 2px;\n  margin: 8px 6px 0 6px;\n"])),(function(e){return e.theme.neutral3})),D=g.styled.View(p||(p=(0,y.default)(["\n  display: inline-flex;\n  padding: 4px 8px;\n  justify-content: center;\n  align-items: center;\n  gap: 4px;\n  border-radius: 40px;\n  background-color: rgba(0, 0, 0, 0.65);\n  position: absolute;\n  top: 8px;\n  left: 8px;\n  z-index: 10;\n"]))),I=g.styled.Text(h||(h=(0,y.default)(["\n  color: #fff;\n  /* Caption/caption-medium-500 */\n  font-family: ",";\n  font-size: 12px;\n  line-height: 16px; /* 133.333% */\n"])),g.Fonts.Medium)},5639:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.EventScreen=void 0;var a=r(n(17156)),i=r(n(27424)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=a?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(84481)),u=n(55766),o=n(4007),l=n(20349),d=n(91087),c=n(83899),f=n(75867),v=n(79837),p=n(33823);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}t.EventScreen=(0,s.memo)((function(){var e,t=(0,s.useState)({}),n=(0,i.default)(t,2),r=n[0],h=(n[1],(0,s.useState)("")),y=(0,i.default)(h,2),b=y[0],g=y[1],m=(0,s.useCallback)((e=(0,a.default)((function*(e){g(e)})),function(t){return e.apply(this,arguments)}),[r]),x=(0,s.useCallback)((function(e){return(e||[]).filter((function(e){var t;return(0,o.normalizeStringForSearch)((null==(t=(0,f.getEvents)(e))?void 0:t.name)||"").includes(b)}))}),[b]),j=(0,s.useCallback)((function(e,t,n){return(0,p.jsx)(c.EventThumbnail,{id:e})}),[]);return(0,p.jsxs)(d.ScreenWrapper,{isGrey:!0,children:[(0,p.jsx)(u.CustomHeader,{title:"Events",isBack:!0,onCreate:function(){(0,l.navigateToCreateEvent)({id:-1})},isSearch:!0,onChangeText:m}),(0,p.jsxs)(d.ScrollableTabView.Provider,{params:{},renderItem:j,getItemByQuery:f.getEventsByQuery,useItemByQuery:f.useEventsByQuery,tabs:[{title:"Public events",content:function(e){return(0,p.jsx)(d.ScrollableTabView.List,Object.assign({},e,{itemHeight:190,index:0,requestFn:v.requestPublicEvents,setData:x}))}},{title:"Joined events",content:function(e){return(0,p.jsx)(d.ScrollableTabView.List,Object.assign({},e,{itemHeight:190,index:1,requestFn:v.requestJoinedEvents,query:"joined",setData:x}))}}],children:[(0,p.jsx)(d.ScrollableTabView.CollapsableTabBar,{}),(0,p.jsx)(d.ScrollableTabView.Content,{})]})]})}))},79837:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.requestRemoveEvent=t.requestPublicEvents=t.requestJoinedEvents=t.requestInviteEvent=t.requestEventsProfile=t.requestEventsJoinedChannel=t.requestEventsChannel=t.requestEvent=t.requestEditEvent=t.requestCreateEvent=t.requestAttendEvent=void 0;var a,i,s,u,o,l,d,c,f,v,p,h=r(n(861)),y=r(n(38416)),b=r(n(17156)),g=n(4007),m=n(30806),x=n(75867),j=n(60569);t.requestPublicEvents=(a=(0,b.default)((function*(){var e=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/event/gets")).data;return(0,m.batch)((function(){e.events.length&&((0,x.syncEvents)(e.events),(0,x.setEventsQuery)((function(t){return Object.assign({},t,(0,y.default)({},"all",e.events.map((function(e){return e.id.toString()}))))})))})),e.events})),function(){return a.apply(this,arguments)}),t.requestJoinedEvents=(i=(0,b.default)((function*(){var e=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/event/joined")).data;return(0,m.batch)((function(){e.events.length&&((0,x.syncEvents)(e.events),(0,x.setEventsQuery)((function(t){return Object.assign({},t,(0,y.default)({},"joined",e.events.map((function(e){return e.id.toString()}))))})))})),e.events})),function(){return i.apply(this,arguments)}),t.requestEvent=(s=(0,b.default)((function*(e){var t=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/event/get?event_id="+e.event_id)).data;return(0,m.batch)((function(){t.event&&(0,x.syncEvents)([t.event])})),t.event})),function(e){return s.apply(this,arguments)}),t.requestCreateEvent=(u=(0,b.default)((function*(e){var t=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/event/create",e)).data;(0,m.batch)((function(){t.event&&((0,x.syncEvents)([t.event]),(0,x.setEventsQuery)((function(e){return Object.assign({},e,(0,y.default)({},"all",[t.event.id.toString()].concat((0,h.default)(e.all||[]))))})))}))})),function(e){return u.apply(this,arguments)}),t.requestEditEvent=(o=(0,b.default)((function*(e,t){var n=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/event/edit",e)).data;(0,m.batch)((function(){if(n.event){if(t&&t>0){var e=(0,j.getUpdates)(t);e&&(0,j.syncUpdates)([Object.assign({},e,{attachment:n.event})])}(0,x.syncEvents)([n.event])}}))})),function(e,t){return o.apply(this,arguments)}),t.requestRemoveEvent=(l=(0,b.default)((function*(e){var t=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/event/remove",e)).data;(0,m.batch)((function(){"ok"===t.message&&(0,x.setEventsQuery)((function(t){return Object.assign({},t,(0,y.default)({},"all",(t.all||[]).filter((function(t){return t!==e.id.toString()}))))}))}))})),function(e){return l.apply(this,arguments)}),t.requestAttendEvent=(d=(0,b.default)((function*(e){"ok"==(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/event/attendee/attend",e)).data.message&&((0,x.syncEvents)([Object.assign({},e.data,{attendees:(0,h.default)(new Set([].concat((0,h.default)(e.data.attendees),[Number(e.myId)])))})]),g.ToastService.show("Attend event successfully"))})),function(e){return d.apply(this,arguments)}),t.requestInviteEvent=(c=(0,b.default)((function*(e){"ok"==(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/event/attendee/invite",e)).data.message&&e.data&&((0,x.syncEvents)([Object.assign({},e.data,{attendees:(0,h.default)(new Set([].concat((0,h.default)(e.data.attendees),(0,h.default)(e.ids))))})]),g.ToastService.show("Invite event successfully"))})),function(e){return c.apply(this,arguments)}),t.requestEventsChannel=(f=(0,b.default)((function*(e){var t=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/channel/update/event?path="+e.path+(null!=e&&e.q?"&q="+e.q:""))).data;return console.log("asd"),(0,m.batch)((function(){t.events.length&&((0,x.syncEvents)(t.events),(0,x.setEventsQuery)((function(n){return Object.assign({},n,(0,y.default)({},e.path,t.events.map((function(e){return e.id.toString()}))))})))})),t.events})),function(e){return f.apply(this,arguments)}),t.requestEventsJoinedChannel=(v=(0,b.default)((function*(e){var t=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/channel/update/event?path="+e.path+"&state=joined"+(null!=e&&e.q?"&q="+e.q:""))).data;return(0,m.batch)((function(){t.events.length&&(0,x.setEventsQuery)((function(n){return Object.assign({},n,(0,y.default)({},"joined_"+e.path,t.events.map((function(e){return e.id.toString()}))))}))})),t.events})),function(e){return v.apply(this,arguments)}),t.requestEventsProfile=(p=(0,b.default)((function*(e){var t=(yield g.Fetch.postWithToken("@"+g.Core.systemPath+"/inside/ajax/api/profile/get?tail=events&username="+e.username)).data;(0,m.batch)((function(){t.events.length&&((0,x.syncEvents)(t.events),(0,x.setEventsQuery)((function(n){return Object.assign({},n,(0,y.default)({},e.username,t.events.map((function(e){return e.id.toString()}))))})))}))})),function(e){return p.apply(this,arguments)})}}]);//# sourceMappingURL=src_screens_EventScreen_index_tsx.chunk.bundle.map?platform=android