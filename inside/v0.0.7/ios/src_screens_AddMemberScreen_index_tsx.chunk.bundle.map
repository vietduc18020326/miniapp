{"version":3,"file":"src_screens_AddMemberScreen_index_tsx.chunk.bundle","mappings":"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","sources":["webpack:///./src/screens/AddMemberScreen/index.tsx"],"sourcesContent":["import React, {memo, useCallback, useRef} from 'react';\nimport {\n  interpolateColor,\n  runOnUI,\n  useAnimatedStyle,\n  useSharedValue,\n} from 'react-native-reanimated';\nimport {StyleSheet} from 'react-native';\nimport {\n  Colors,\n  Fonts,\n  getUser,\n  getUserByQuery,\n  getUserGroup,\n  goBack,\n  styled,\n  useAsyncFn,\n  useAutoToastError,\n  useNavigationParams,\n  useTheme,\n} from '@true/core';\nimport {\n  AnimatedBottomSpace,\n  AnimatedKeyboardAvoidingViewRef,\n  FullScreenWrapper,\n  LeftModalHeader,\n  MyKeyboardAvoidingView,\n  UIBottomButton,\n  UIButton,\n  UIUserPickerInput,\n} from '@true/ui';\nimport {Icons} from '@true/asset';\n\nexport interface AddMemberScreenProps {\n  ids: number[];\n  onSubmit: (ids: number[], usernameIds: string) => void;\n}\n\nexport const AddMemberScreen = memo(() => {\n  const {ids, onSubmit} = useNavigationParams<AddMemberScreenProps>();\n  const offset = useSharedValue(100);\n  const ref = useRef<AnimatedKeyboardAvoidingViewRef>(null);\n  const scrollRef = useRef<any>(null);\n  const inputRef = useRef<any>(null);\n  const theme = useTheme();\n  const followers = ids;\n  const params = useSharedValue({\n    followers: (followers && followers) || [],\n    groups: [],\n  });\n\n  const onChangeValue = useCallback(\n    (key: string, value: any) => {\n      if (key === 'groups') {\n        let _followers = params.value.followers;\n        value\n          .map((groupId: any) => {\n            const group = getUserGroup(groupId);\n            if (group && group.metatype === 'group') {\n              _followers = _followers.concat(\n                // @ts-ignore\n                getUserByQuery(`userGroup/${groupId}`),\n              );\n            }\n          })\n          .filter(Boolean);\n        params.value = {\n          ...params.value,\n          followers: [...new Set(_followers)],\n        };\n\n        return;\n      }\n      runOnUI((_key, _value) => {\n        'worklet';\n        params.value = {\n          ...params.value,\n          // @ts-ignore\n          [_key]: _value,\n        };\n      })(key, value);\n    },\n    [params],\n  );\n\n  const [{loading: shareLoading, error: shareError}, onRequestAdd] =\n    useAsyncFn(async () => {\n      let _followers: any[] = params.value.followers;\n\n      const _followersUserName = [...new Set(_followers)].map(\n        id => '@' + getUser(id)?.username,\n      );\n      onSubmit(_followers, _followersUserName.join(' '));\n      goBack();\n    }, [params]);\n\n  const animatedButtonStyle = useAnimatedStyle(() => {\n    const disabled = !params.value['followers'] ? 1 : 0;\n    return {\n      backgroundColor: interpolateColor(\n        disabled,\n        [0, 1],\n        [theme.primaryColor, theme.neutral3],\n      ),\n    };\n  });\n\n  useAutoToastError(shareError);\n\n  return (\n    <FullScreenWrapper>\n      <LeftModalHeader hideSeparator={false} title={'Invite members'} />\n      <MyKeyboardAvoidingView\n        ref={ref}\n        scrollRef={scrollRef}\n        scrollInputAdditionalOffset={offset}>\n        <SScrollView ref={scrollRef} keyboardShouldPersistTaps={'handled'}>\n          {/*<SContainer>*/}\n          {/*  <STitle>{translate('truesign.share_template_hint')}</STitle>*/}\n          {/*</SContainer>*/}\n\n          <SContainer>\n            <UIUserPickerInput\n              type={'user'}\n              keyName={'followers'}\n              multiple={true}\n              title={'Invite members'}\n              onChangeValue={onChangeValue}\n              params={params}\n            />\n          </SContainer>\n\n          <SViewHidden>\n            <UIUserPickerInput\n              type={'group'}\n              keyName={'groups'}\n              multiple={true}\n              title={'Invite members groups'}\n              onChangeValue={onChangeValue}\n              ref={inputRef}\n            />\n          </SViewHidden>\n          <SContainer>\n            <UIButton\n              title={'Select group users'}\n              textStyle={styles.textStyleGroup}\n              source={Icons.Outlined.CHEVRON_RIGHT}\n              imageSize={14}\n              imageStyle={styles.imageStyle}\n              onPress={() => {\n                inputRef?.current?.bottomSheetRef?.current?.present();\n              }}\n            />\n          </SContainer>\n          <AnimatedBottomSpace />\n        </SScrollView>\n      </MyKeyboardAvoidingView>\n\n      <SBottomButton\n        buttons={[\n          {\n            title: 'Cancel',\n            onPress: goBack,\n            textColor: theme.primaryColor,\n            backgroundColor: 'white',\n            style: {\n              borderWidth: 1,\n              borderColor: theme.primaryColor,\n            },\n            textStyle: styles.textStyle,\n          },\n          {\n            title: 'Add',\n            loading: shareLoading,\n            onPress: onRequestAdd,\n            textColor: 'white',\n            backgroundColor: theme.primaryColor,\n            textStyle: styles.textStyle,\n            style: animatedButtonStyle,\n          },\n        ]}\n      />\n    </FullScreenWrapper>\n  );\n});\n\nconst styles = StyleSheet.create({\n  textStyle: {\n    fontFamily: Fonts.Medium,\n    fontSize: 16,\n    lineHeight: 24,\n    marginRight: 8,\n  },\n  textStyleGroup: {color: Colors.blue1},\n  imageStyle: {tintColor: Colors.blue1, justifyContent: 'center'},\n});\n\nconst SScrollView = styled.ScrollView``;\n\nconst SContainer = styled.View`\n  flex: 1;\n  padding: 20px 16px 0 16px;\n`;\n\nconst SViewHidden = styled.View`\n  overflow: hidden;\n  height: 0;\n`;\n\nconst SBottomButton = styled(UIBottomButton)`\n  padding: 8px 16px;\n  margin: 0;\n  background-color: ${p => p.theme.backgroundColor};\n  border-top-width: 1px;\n  border-color: ${p => p.theme.neutral06};\n`;\n"],"names":["_templateObject","_templateObject2","_templateObject3","_templateObject4","_react","e","r","__esModule","default","t","_getRequireWildcardCache","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","_interopRequireWildcard","require","_reactNativeReanimated","_reactNative","_core","_ui","_asset","_jsxRuntime","WeakMap","_worklet_690685769123_init_data","code","_worklet_10218680782661_init_data","styles","exports","memo","anonymous","_useNavigationParams","useNavigationParams","ids","onSubmit","offset","useSharedValue","ref","useRef","scrollRef","inputRef","theme","useTheme","followers","params","groups","onChangeValue","useCallback","key","value","_followers","map","groupId","group","getUserGroup","metatype","concat","getUserByQuery","filter","Boolean","assign","_toConsumableArray2","Set","runOnUI","_key","_value","_defineProperty2","__closure","__initData","__workletHash","_useAsyncFn","useAsyncFn","_asyncToGenerator2","_followersUserName","id","_getUser","getUser","username","join","goBack","_useAsyncFn2","_slicedToArray2","_useAsyncFn2$","shareLoading","loading","shareError","error","onRequestAdd","animatedButtonStyle","useAnimatedStyle","disabled","backgroundColor","interpolateColor","primaryColor","neutral3","useAutoToastError","jsxs","FullScreenWrapper","children","jsx","LeftModalHeader","hideSeparator","title","MyKeyboardAvoidingView","scrollInputAdditionalOffset","SScrollView","keyboardShouldPersistTaps","SContainer","UIUserPickerInput","type","keyName","multiple","SViewHidden","UIButton","textStyle","textStyleGroup","source","Icons","Outlined","CHEVRON_RIGHT","imageSize","imageStyle","onPress","_inputRef$current","_inputRef$current$bot","_inputRef$current$bot2","current","bottomSheetRef","present","AnimatedBottomSpace","SBottomButton","buttons","textColor","style","borderWidth","borderColor","StyleSheet","create","fontFamily","Fonts","Medium","fontSize","lineHeight","marginRight","color","Colors","blue1","tintColor","justifyContent","styled","ScrollView","_taggedTemplateLiteralLoose2","View","UIBottomButton","p","neutral06"],"sourceRoot":""}