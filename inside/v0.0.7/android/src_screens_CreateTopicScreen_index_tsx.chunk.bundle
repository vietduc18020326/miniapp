(self.webpackChunkInside=self.webpackChunkInside||[]).push([["src_screens_CreateTopicScreen_index_tsx"],{92551:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.AvatarWithSelectChannel=void 0;var a,o,i,u,l=r(n(19452)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=v(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(84481)),c=n(4007),d=n(91087),p=n(46763),f=n(25277),h=n(33823);function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(v=function(e){return e?n:t})(e)}var y={code:"function anonymous(){const{widthButton}=this.__closure;return{width:widthButton.value};}"},_={code:"function anonymous(e){const{widthButton}=this.__closure;widthButton.value=e.nativeEvent.layout.width;}"},m=(t.AvatarWithSelectChannel=(0,s.memo)((function(e){var t,n=e.bottomSheetRef,r=e.label,a=e.typePost,o=(0,c.useMe)(),i=(0,p.useSharedValue)(200),u=(0,p.useAnimatedStyle)(((t=function(){return{width:i.value}}).__closure={widthButton:i},t.__initData=y,t.__workletHash=8674385749251,t),[]),l=(0,p.useWorkletCallback)(function(){var e=function(e){i.value=e.nativeEvent.layout.width};return e.__closure={widthButton:i},e.__initData=_,e.__workletHash=0xcd259325f91,e}(),[i]);return(0,h.jsxs)(m,{children:[(0,h.jsx)(d.Avatar,{size:48,userKey:(null==o?void 0:o.id)||"0",disableClick:!0}),(0,h.jsxs)(x,{children:[(0,h.jsxs)(d.UIText.BodyMedium500,{onLayout:l,children:[null==o?void 0:o.name," create ",a]}),(0,h.jsx)(b,{style:u,title:r||"Select channel",onPress:function(){var e;null==(e=n.current)||e.present()},children:(0,h.jsx)(g,{source:f.Icons.Outlined.CHEVRON_DOWN_SMALL})})]})]})})),c.styled.View(a||(a=(0,l.default)(["\n  flex-direction: row;\n  align-items: center;\n  gap: 12px;\n"])))),x=c.styled.View(o||(o=(0,l.default)(["\n  justify-content: center;\n  gap: 4px;\n"]))),b=(0,c.styled)(d.UIButton).attrs((function(e){return{textStyle:Object.assign({},d.UITextStyle.body_medium_400,{color:e.theme.neutral2,width:"85%"}),textProps:{numberOfLines:1}}}))(i||(i=(0,l.default)(["\n  flex-direction: row;\n  border-radius: 40px;\n  border-width: 1px;\n  border-color: ",";\n  justify-content: space-between;\n  align-items: center;\n  height: 32px;\n  padding-left: 16px;\n  padding-right: 8px;\n"])),(function(e){return e.theme.neutral5})),g=c.styled.Image(u||(u=(0,l.default)(["\n  width: 24px;\n  height: 24px;\n  tint-color: ",";\n"])),(function(e){return e.theme.neutral2}))},70075:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderCreatePost=void 0;var a,o,i=r(n(19452)),u=n(84481),l=n(25736),s=n(4007),c=n(25277),d=n(91087),p=n(25200),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=v(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(46763)),h=n(33823);function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(v=function(e){return e?n:t})(e)}var y={code:"function anonymous(){const{aTop}=this.__closure;return{paddingTop:aTop.value};}"},_={code:"function anonymous(){const{interpolateColor,active,theme}=this.__closure;return{backgroundColor:interpolateColor(active.value?1:0,[0,1],[theme.neutral3,theme.primaryColor]),width:'100%'};}"},m={code:"function anonymous(){const{active}=this.__closure;return{pointerEvents:active.value?'auto':'none'};}"},x=(t.HeaderCreatePost=(0,u.memo)((function(e){var t,n=(0,p.useAnimatedSafeAreaInsets)().aTop,r=(0,f.useAnimatedStyle)(((t=function(){return{paddingTop:n.value}}).__closure={aTop:n},t.__initData=y,t.__workletHash=9978501313055,t)),a=(0,s.useTheme)(),o=e.title,i=e.active,u=e.id,v=e.onPress,g=(e.loading,e.onGoBack),j=(0,f.useAnimatedStyle)(function(){var e=function(){return{backgroundColor:(0,f.interpolateColor)(i.value?1:0,[0,1],[a.neutral3,a.primaryColor]),width:"100%"}};return e.__closure={interpolateColor:f.interpolateColor,active:i,theme:a},e.__initData=_,e.__workletHash=0xefaedf5ccd0,e}(),[a]),w=(0,f.useAnimatedProps)(function(){var e=function(){return{pointerEvents:i.value?"auto":"none"}};return e.__closure={active:i},e.__initData=m,e.__workletHash=0xcd0f6a5dae1,e}());return(0,h.jsxs)(x,{style:r,children:[(0,h.jsxs)(l.FlexCenter,{gap:8,children:[(0,h.jsx)(d.UIButton,{source:c.Icons.Outlined.CHEVRON_LEFT,onPress:g||s.goBack}),(0,h.jsx)(d.UIText.HeaderLarge,{children:o})]}),(0,h.jsx)(f.default.View,{animatedProps:w,children:(0,h.jsx)(b,{title:u?"Update":"Create",onPress:v,style:j})})]})})),(0,s.styled)(f.default.View)(a||(a=(0,i.default)(["\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom-color: ",";\n  border-bottom-width: 1px;\n  padding: 6px 16px;\n  background-color: white;\n"])),(function(e){return e.theme.neutral4}))),b=(0,s.styled)(d.UIButton).attrs((function(e){return{textStyle:Object.assign({},d.UITextStyle.body_medium_500,{color:"#fff"})}}))(o||(o=(0,i.default)(["\n  width: 94px;\n  height: 32px;\n  border-radius: 8px;\n  align-items: center;\n  justify-content: center;\n  padding: 4px 16px;\n  background-color: ",";\n"])),(function(e){return e.theme.primaryColor}))},60780:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.CreateTopicScreen=void 0;var a,o,i,u=r(n(19452)),l=r(n(38416)),s=r(n(17156)),c=r(n(27424)),d=I(n(84481)),p=n(4007),f=I(n(46763)),h=n(91087),v=n(11361),y=n(92910),_=n(86702),m=n(12715),x=n(16300),b=n(58672),g=n(73781),j=n(33435),w=n(19855),C=n(92551),k=n(70075),T=r(n(78663)),O=n(58053),P=n(33823);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}function I(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}var M={code:"function anonymous(){const{params}=this.__closure;return!!params.value.content;}"},W={code:"function anonymous(_key,_value){const{params}=this.__closure;params.value={...params.value,[_key]:_value};}"},A=(t.CreateTopicScreen=(0,d.memo)((function(){var e=(0,p.useNavigationParams)().id,t=(0,d.useRef)(null),n=(0,f.useAnimatedRef)(),r=(0,f.useSharedValue)(m.initCreateTopic),a=(0,p.useBoolean)(),o=(0,c.default)(a,3),i=o[0],u=(o[1],o[2]),S=(0,d.useRef)(null),I=(0,d.useState)(""),D=(0,c.default)(I,2),U=D[0],H=D[1],E=(0,g.useChannelsByQuery)("joined").map((function(e){var t;return{label:(null==(t=(0,g.getChannels)(e))?void 0:t.name)||"Undefined channel",value:e}})),q=(0,_.useAsyncFn)((0,s.default)((function*(){-1!==e?yield(0,b.requestEditTopic)(r.value):(yield(0,b.requestCreateTopic)(r.value),p.ToastService.show("Create topic successfully")),(0,p.goBack)()})),[e,r]),F=(0,c.default)(q,2),N=F[0],R=N.loading,L=N.error,Q=F[1];(0,p.useAutoToastError)(L);var G=(0,d.useCallback)((function(){(0,p.goBack)()}),[]);(0,d.useEffect)((function(){var t=Object.assign({},m.initCreateTopic);if(e>0){var n=(0,x.getTopics)(e);t={channel_id:0,id:null==n?void 0:n.id,content:(null==n?void 0:n.content)||"",name:(null==n?void 0:n.name)||"","file[]":null==n?void 0:n.files,followers:null==n?void 0:n.followers,privacy:null==n?void 0:n.privacy}}r.value=t}),[e,r]);var K,z=(0,f.useDerivedValue)(((K=function(){return!!r.value.content}).__closure={params:r},K.__initData=M,K.__workletHash=3835743809214,K),[]),Y=(0,d.useCallback)((function(e,t){return(0,P.jsx)(w.MenuItem,{title:e.label,onPress:function(){var t;J("channel_id",e.value),H(e.label),null==(t=S.current)||t.dismiss()}},t)}),[S]),J=(0,d.useCallback)((function(e,t){(0,f.runOnUI)(function(){var e=function(e,t){r.value=Object.assign({},r.value,(0,l.default)({},e,t))};return e.__closure={params:r},e.__initData=W,e.__workletHash=690685769123,e}())(e,t)}),[r]);return(0,P.jsxs)(h.FullScreenWrapper,{isGrey:!0,children:[(0,P.jsxs)(h.MyKeyboardAvoidingView,{ref:t,scrollRef:n,children:[(0,P.jsx)(T.default,{isVisible:R}),(0,P.jsx)(k.HeaderCreatePost,{title:-1===e?"Create a topic":"Edit topic",onPress:Q,active:z,id:e,loading:R,onGoBack:G}),(0,P.jsx)(V,{ref:n,keyboardShouldPersistTaps:"handled",children:(0,P.jsxs)(A,{children:[(0,P.jsxs)(B,{children:[(0,P.jsx)(C.AvatarWithSelectChannel,{bottomSheetRef:S,label:U,typePost:"an event"}),(0,P.jsx)(h.UIInput.Text,{title:"Title",keyName:"name",params:r,placeholder:"---",defaultValue:"",onChangeValue:J,required:!0}),(0,P.jsx)(h.UITextInput,{title:"Content",keyName:"content",params:r,defaultValue:"",onChangeValue:J}),(0,P.jsx)(h.UIInput.Attachment,{title:"Attach files or Images",keyName:"file[]",params:r,onChangeValue:J}),(0,P.jsx)(h.UIInput.UserPicker,{title:"Followers",keyName:"followers",params:r,type:"user"})]}),(0,P.jsxs)(B,{children:[(0,P.jsx)(h.UIText.HeaderMedium,{children:"Advanced settings"}),(0,P.jsx)(O.CheckboxWithText,{params:r,keyName:"privacy",title:"Only visible to selected followers"}),(0,P.jsx)(v.AnimatedBottomSpace,{})]})]})})]}),(0,P.jsx)(y.DiscardDialog,{title:"Discard change",content:"You have made changes to this item that have not been saved. If you leave this page, your changes will be lost.",visible:i,onClose:u}),(0,P.jsx)(j.BottomSheetMenu,{name:"channel",ref:S,items:E,renderMenuItem:Y,titleHeader:"Select channel"})]})})),(0,p.styled)(f.default.View)(a||(a=(0,u.default)(["\n  flex: 1;\n  gap: 8px;\n"])))),B=p.styled.View(o||(o=(0,u.default)(["\n  margin-top: 8px;\n  background-color: white;\n  padding: 12px 16px;\n  gap: 8px;\n"]))),V=p.styled.ScrollView(i||(i=(0,u.default)(["\n  flex: 1;\n"])))},58672:function(e,t,n){var r=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.requestTopicsChannel=t.requestMyTopicsChannel=t.requestEditTopic=t.requestCreateTopic=void 0;var a,o,i,u,l=r(n(861)),s=r(n(38416)),c=r(n(17156)),d=n(4007),p=n(30806),f=n(16300);t.requestTopicsChannel=(a=(0,c.default)((function*(e){var t=(yield d.Fetch.postWithToken("@"+d.Core.systemPath+"/inside/ajax/api/channel/update/topic?path="+e.path)).data;return(0,p.batch)((function(){t.topics.length&&((0,f.syncTopics)(t.topics),(0,f.setTopicsQuery)((function(n){return Object.assign({},n,(0,s.default)({},e.path,t.topics.map((function(e){return e.id.toString()}))))})))})),t.topics})),function(e){return a.apply(this,arguments)}),t.requestMyTopicsChannel=(o=(0,c.default)((function*(e){var t=(yield d.Fetch.postWithToken("@"+d.Core.systemPath+"/inside/ajax/api/channel/update/topic?path="+e.path+"&created=mine")).data;return(0,p.batch)((function(){t.topics.length&&((0,f.syncTopics)(t.topics),(0,f.setTopicsQuery)((function(n){return Object.assign({},n,(0,s.default)({},"created_"+e.path,t.topics.map((function(e){return e.id.toString()}))))})))})),t.topics})),function(e){return o.apply(this,arguments)}),t.requestCreateTopic=(i=(0,c.default)((function*(e){var t=(yield d.Fetch.postWithToken("@"+d.Core.systemPath+"/inside/ajax/api/topic/create",e)).data;(0,p.batch)((function(){t.topic&&((0,f.syncTopics)([t.topic]),(0,f.setTopicsQuery)((function(e){return Object.assign({},e,(0,s.default)({},"all",[t.topic.id.toString()].concat((0,l.default)(e.all||[]))))})))}))})),function(e){return i.apply(this,arguments)}),t.requestEditTopic=(u=(0,c.default)((function*(e){var t=(yield d.Fetch.postWithToken("@"+d.Core.systemPath+"/inside/ajax/api/topic/edit",e)).data;(0,p.batch)((function(){t.topic&&(0,f.syncTopics)([t.topic])}))})),function(e){return u.apply(this,arguments)})},12715:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.initCreateTopic=void 0;t.initCreateTopic={name:"",content:"",channel_id:0}}}]);//# sourceMappingURL=src_screens_CreateTopicScreen_index_tsx.chunk.bundle.map?platform=android